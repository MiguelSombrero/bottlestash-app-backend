(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{131:function(e,t,a){},132:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),l=a(21),c=a.n(l),s=a(10),u=a(2),o=a.n(u),i=a(7),m=a(6),f=a(32),p=a.n(f),d=null,b=function(e){d="bearer ".concat(e)},E=function(e){var t=function(){var t=Object(i.a)(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.get(e);case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),a=function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.get("".concat(e,"/").concat(a));case 2:return r=t.sent,t.abrupt("return",r.data);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),r=function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={headers:{Authorization:d}},t.next=3,p.a.post(e,a,r);case 3:return n=t.sent,t.abrupt("return",n.data);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),n=function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.post(e,a);case 2:return r=t.sent,t.abrupt("return",r.data);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return{create:r,createImage:function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={headers:{Authorization:d,"content-type":"multipart/form-data"}},t.next=3,p.a.post(e,a,r);case 3:return n=t.sent,t.abrupt("return",n.data);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getAll:t,getOne:a,update:function(){var t=Object(i.a)(o.a.mark(function t(a,r){var n,l;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={headers:{Authorization:d}},t.next=3,p.a.put("".concat(e,"/").concat(a),r,n);case 3:return l=t.sent,t.abrupt("return",l.data);case 5:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}(),remove:function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={headers:{Authorization:d}},t.next=3,p.a.delete("".concat(e,"/").concat(a),r);case 3:return n=t.sent,t.abrupt("return",n.data);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),login:n}},h=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=Object(r.useState)(""),c=Object(m.a)(l,2),s=c[0],u=c[1],o=Object(r.useState)(""),i=Object(m.a)(o,2),f=i[0],p=i[1];return[{type:e,minLength:t,maxLength:a,required:n,value:s,onChange:function(e){u(e.target.value)},onInvalid:function(e){p(e.target.validationMessage)}},f,function(e){u(e)}]},v=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=Object(r.useState)(""),s=Object(m.a)(c,2),u=s[0],o=s[1],i=Object(r.useState)(""),f=Object(m.a)(i,2),p=f[0],d=f[1];return[{type:e,min:t,max:a,step:n,required:l,value:u,onChange:function(e){o(e.target.value)},onInvalid:function(e){d(e.target.validationMessage)}},p,function(e){o(e)}]},g=E("/api/login"),y=function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedBottlestashUser"),b(null),t({type:"LOGOUT"});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.user;case"LOGOUT":return null;default:return e}},x=a(16),O=E("/api/users"),k=function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.getOne(e);case 2:return r=t.sent,a({type:"UPDATE_USER_TO_STATE",user:r}),t.abrupt("return",r);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USERS":return t.users;case"UPDATE_USER_TO_STATE":return e.map(function(e){return e.id!==t.user.id?e:t.user});case"REMOVE_USER":return e.filter(function(e){return e.id!==t.id});case"UPDATE_USER":return e.map(function(e){return e.id===t.updatedUser.id?t.updatedUser:e});case"REGISTER_USER":return[].concat(Object(x.a)(e),[t.newUser]);default:return e}},j=E("/api/breweries"),C=function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.getOne(e);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},T=function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.create(e);case 2:return r=t.sent,a({type:"ADD_BREWERY",brewery:r}),t.abrupt("return",r);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_BREWERIES":return t.breweries;case"ADD_BREWERY":return[].concat(Object(x.a)(e),[t.brewery]);default:return e}},L=E("/api/beers"),S=function(e,t,a){return function(){var r=Object(i.a)(o.a.mark(function r(n){var l;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,L.getOne("".concat(e,"/").concat(t,"/").concat(a));case 2:return l=r.sent,r.abrupt("return",l);case 4:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}()},A=function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L.create(e);case 2:return r=t.sent,a({type:"ADD_BEER",beer:r}),t.abrupt("return",r);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_BEERS":return t.beers;case"ADD_BEER":return[].concat(Object(x.a)(e),[t.beer]);default:return e}},R=E("/api/ratings"),F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_RATINGS":return t.ratings;case"ADD_RATING":return[].concat(Object(x.a)(e),[t.rating]);default:return e}},I=E("/api/bottles"),U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_BOTTLES":return t.bottles;case"ADD_BOTTLE":return[].concat(Object(x.a)(e),[t.newBottle]);case"REMOVE_BOTTLE":return e.filter(function(e){return e.id!==t.id});case"UPDATE_BOTTLE":return e.map(function(e){return e.id===t.updatedBottle.id?t.updatedBottle:e});default:return e}},D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";return function(){var a=Object(i.a)(o.a.mark(function a(r){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:r({type:"SET_NOTIFICATION",notification:{message:e,type:t}}),setTimeout(function(){r({type:"CLEAR_NOTIFICATION"})},4e3);case 2:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.notification;case"CLEAR_NOTIFICATION":return null;default:return e}},V=a(8),P=a(30),Y=a(134),M=a(135),W=a(136),H=a(78),q=a(140),J=a(137),z={loginUser:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.login(e);case 2:r=t.sent,window.localStorage.setItem("loggedBottlestashUser",JSON.stringify(r)),b(r.token),a({type:"LOGIN",user:r});case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}},K=Object(s.b)(null,z)(Object(P.e)(function(e){var t=h("text",5,20,!0),a=Object(m.a)(t,1)[0],r=h("password",5,20,!0),l=Object(m.a)(r,1)[0],c=function(){var t=Object(i.a)(o.a.mark(function t(r){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),t.prev=1,t.next=4,e.loginUser({username:a.value,password:l.value});case 4:e.history.push("/"),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),e.setNotification("Login failed","error");case 10:case"end":return t.stop()}},t,null,[[1,7]])}));return function(e){return t.apply(this,arguments)}}();return n.a.createElement(Y.a,{fluid:!0},n.a.createElement(M.a,null,n.a.createElement(W.a,{as:H.a,className:"text-center"},n.a.createElement("h2",null,"Login to Bottlestash"))),n.a.createElement(M.a,{id:"loginForm"},n.a.createElement(H.a,{className:"formstyle"},n.a.createElement(q.a,{onSubmit:c},n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Username"),n.a.createElement(q.a.Control,Object.assign({},a,{placeholder:"username"}))),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Password"),n.a.createElement(q.a.Control,Object.assign({},l,{placeholder:"password"}))),n.a.createElement(J.a,{id:"login",variant:"success",type:"submit",block:!0},"Login")),n.a.createElement(M.a,{className:"mt-2"},n.a.createElement(H.a,{className:"text-center"},n.a.createElement("small",null,"Not yet a member?",n.a.createElement(V.b,{to:"/register"}," Register here")))))))})),Q=a(144),X=a(138),Z=a(15),$=a.n(Z),ee=function(e){var t=e.rating;return n.a.createElement(Q.a,{className:"text-center p-2 m-2"},n.a.createElement(Q.a.Header,{style:{backgroundColor:"white",color:"rgb(52, 58, 64)"}},n.a.createElement(Q.a.Title,null,n.a.createElement(V.c,{to:"/beers/".concat(t.beer.id,"/")},t.beer.name," ",t.beer.abv," %")),n.a.createElement("small",{className:"text-left"},"brewery: ",n.a.createElement(V.c,{to:"/breweries/".concat(t.beer.brewery.id,"/")},t.beer.brewery.name))),n.a.createElement(X.a,{responsive:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,n.a.createElement("small",{className:"text-muted"},"aroma")),n.a.createElement("th",null,n.a.createElement("small",{className:"text-muted"},"taste")),n.a.createElement("th",null,n.a.createElement("small",{className:"text-muted"},"mouthfeel")),n.a.createElement("th",null,n.a.createElement("small",{className:"text-muted"},"appearance")),n.a.createElement("th",null,n.a.createElement("small",{className:"text-muted"},"overall")))),n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("small",{className:"text-muted"},t.aroma,"/10")),n.a.createElement("td",null,n.a.createElement("small",{className:"text-muted"},t.taste,"/10")),n.a.createElement("td",null,n.a.createElement("small",{className:"text-muted"},t.mouthfeel,"/5")),n.a.createElement("td",null,n.a.createElement("small",{className:"text-muted"},t.appearance,"/5")),n.a.createElement("td",null,n.a.createElement("small",{className:"text-muted"},t.overall,"/20"))))),n.a.createElement(Q.a.Body,null,t.picture&&n.a.createElement(Q.a.Img,{src:"/api/pictures/".concat(t.picture),className:"img-thumbnail",alt:""}),n.a.createElement("blockquote",{className:"blockquote mt-2"},t.description),n.a.createElement("footer",{className:"blockquote-footer"}," ",n.a.createElement("cite",null,t.user.name))),n.a.createElement(Q.a.Footer,null,n.a.createElement("small",{className:"text-muted"},"by ",n.a.createElement(V.c,{to:"/users/".concat(t.user.id,"/stash")},t.user.name),", ",$()(t.added).fromNow())))},te=function(e){var t=e.bottle;return t?n.a.createElement(Q.a,{className:"p-2 m-2 text-center"},n.a.createElement(Q.a.Header,{style:{backgroundColor:"white",color:"rgb(52, 58, 64)"}},n.a.createElement(Q.a.Title,null,n.a.createElement(V.c,{to:"/beers/".concat(t.beer.id)},t.beer.name," ",t.beer.abv," %")),n.a.createElement("small",{className:"text-left"},"brewery: ",n.a.createElement(V.c,{to:"/breweries/".concat(t.beer.brewery.id)},t.beer.brewery.name))),n.a.createElement(Q.a.Body,null,t.picture&&n.a.createElement(Q.a.Img,{src:"/api/pictures/".concat(t.picture),className:"img-thumbnail",alt:""})),n.a.createElement(Q.a.Footer,null,n.a.createElement("small",{className:"text-muted"},"added by ",n.a.createElement(V.c,{to:"/users/".concat(t.user.id,"/stash")},t.user.name),", ",$()(t.added).fromNow()))):null},ae=function(e){var t=Object(r.useState)(5),a=Object(m.a)(t,2),l=a[0],c=a[1],s=e.resources.slice(0,l);return n.a.createElement(n.a.Fragment,null,n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv"},s.map(function(t){return"rating"===e.resource?n.a.createElement(ee,{key:t.id,rating:t}):n.a.createElement(te,{key:t.id,bottle:t})}))),n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"d-flex justify-content-center mb-2"},e.resources.length>l&&n.a.createElement(J.a,{onClick:function(){c(l+5)}},"Load more ..."))))},re=function(e){var t=function(e,t){return t.added>e.added?1:-1},a=e.bottles.filter(function(e){return!e.user.hidden}).sort(t),r=e.ratings.sort(t);return n.a.createElement(Y.a,{fluid:!0,className:"home"},n.a.createElement(M.a,null,n.a.createElement(W.a,{as:H.a,className:"text-center"},n.a.createElement("h1",null,"Bottlestash"),n.a.createElement("h5",null,"Cooler than your wine cellar - wetter than Finnish summer"),n.a.createElement("h6",null,"(or something similar)"))),e.user?n.a.createElement(n.a.Fragment,null,n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv"},n.a.createElement("h2",{style:{color:"white"}},"Recently added bottles"))),n.a.createElement(ae,{resources:a,resource:"bottle"}),n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv"},n.a.createElement("h2",{style:{color:"white"}},"Recently added ratings"))),n.a.createElement(ae,{resources:r,resource:"rating"})):n.a.createElement(n.a.Fragment,null,n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv mt-4",style:{backgroundColor:"rgba(245, 245, 245, 0.9)"}},n.a.createElement("h2",{className:"mb-3"},"Bottlestash, eh?"))),n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv",style:{backgroundColor:"rgba(245, 245, 245, 0.9)"}},n.a.createElement("section",null,n.a.createElement("h3",{className:"mb-3"},"That's right mate!"),n.a.createElement("p",null,"Bottlestash is an app which let you keep track of your beer cellar. Because lets face it; you like beer. So do I - it's allright!"),n.a.createElement("p",null,"So you have lot's of good beer in your cellar - or more likely - in your wardrope. Not really sure what and how many bottles, or is their expiration day long gone."),n.a.createElement("p",null,"Bottlestash helps you with that! With Bottlestash you can keep track of your beer cellar, so you can easily track what beers do you have, how many bottles and when to drink them!")))),n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv",style:{backgroundColor:"rgba(245, 245, 245, 0.9)"}},n.a.createElement("h3",{className:"mb-2"},"Main features:"),n.a.createElement("p",null,"Save bottles to your stash"),n.a.createElement("p",null,"Keep track of your beers expiration and drink them before"),n.a.createElement("p",null,"Rate beers you drink"),n.a.createElement("p",null,"Peek other user's cellars and see what beers they have"))),n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv",style:{backgroundColor:"rgba(245, 245, 245, 0.9)"}},n.a.createElement("h3",{className:"mb-2"},"So do we have a deal?"),n.a.createElement("p",null,"Perfect! Register for free and start collect some awesomeness in your stash!"),n.a.createElement(V.c,{to:"/register"},"To registration")))))},ne=a(142),le=a(143),ce=function(e){return{type:"SET_FILTER",filter:e}},se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FILTER":return t.filter;default:return e}},ue=function(e){var t=Object(x.a)(new Set(e.suggestions));return n.a.createElement("datalist",{id:e.id},t.map(function(e){return n.a.createElement("option",{key:e,value:e})}))},oe=Object(s.b)(function(e){return{beers:e.beers,breweries:e.breweries}})(function(e){var t=(e.beers?e.beers.map(function(e){return e.name}):[]).concat(e.breweries?e.breweries.map(function(e){return e.name}):[]);return n.a.createElement(q.a,{onSubmit:e.handleSearch,inline:!0},n.a.createElement(q.a.Control,{list:e.id,name:"filter",type:"text",className:"p-2 m-2",placeholder:"search for bottles, beers and more ..."}),n.a.createElement(ue,{suggestions:t,id:e.id}),n.a.createElement(J.a,{type:"submit"},"Search"))}),ie={logoutUser:y,setFilter:ce},me=Object(s.b)(null,ie)(Object(P.e)(function(e){return n.a.createElement(Y.a,{fluid:!0},n.a.createElement(M.a,null,n.a.createElement(ne.a,{as:H.a,collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark"},n.a.createElement(ne.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),n.a.createElement(ne.a.Collapse,{id:"responsive-navbar-nav"},n.a.createElement(le.a,{className:"mr-auto"},n.a.createElement(le.a.Link,{href:"#",as:"span"},n.a.createElement(V.c,{to:"/"},"Home")),!e.user&&n.a.createElement(n.a.Fragment,null,n.a.createElement(le.a.Link,{href:"#",as:"span"},n.a.createElement(V.c,{to:"/login"},"Login")),n.a.createElement(le.a.Link,{href:"#",as:"span"},n.a.createElement(V.c,{to:"/register"},"Create account"))),e.user&&n.a.createElement(n.a.Fragment,null,n.a.createElement(le.a.Link,{href:"#",as:"span"},n.a.createElement(V.c,{to:"/users/".concat(e.user.id,"/stash")},"Manage stash")),n.a.createElement(le.a.Link,{href:"#",as:"span"},n.a.createElement(V.c,{to:"/rate"},"Rate beer")),n.a.createElement(le.a.Link,{href:"#"},n.a.createElement(le.a.Item,{onClick:function(){e.logoutUser(),e.setNotification("Logout was successfull"),e.history.push("/")}},"Logout")),!e.user.picture&&n.a.createElement(le.a.Link,{href:"#",as:"span"},n.a.createElement(V.c,{to:"/profile"},"Profile")))),e.user&&n.a.createElement(n.a.Fragment,null,e.user.picture&&n.a.createElement(V.c,{to:"/profile"},n.a.createElement(Q.a.Img,{src:"/api/pictures/".concat(e.user.picture),href:"/profile",style:{width:"50px",height:"50px",borderRadius:"50%"},className:"avatar",alt:"Profile"})),n.a.createElement(oe,{handleSearch:function(t){t.preventDefault(),e.setFilter(t.target.filter.value),t.target.filter.value="",e.history.push("/search")},id:"search"}))))))})),fe={registerUser:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.create(e);case 2:r=t.sent,a({type:"REGISTER_USER",newUser:r});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}},pe=Object(s.b)(null,fe)(Object(P.e)(function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),l=a[0],c=a[1],s=h("text",5,20,!0),u=Object(m.a)(s,2),f=u[0],p=u[1],d=h("password",5,20,!0),b=Object(m.a)(d,2),E=b[0],v=b[1],g=h("text",1,20,!0),y=Object(m.a)(g,2),w=y[0],x=y[1],O=h("text",1,50,!0),k=Object(m.a)(O,2),N=k[0],j=k[1],C=h("text",1,50,!1),T=Object(m.a)(C,2),B=T[0],L=T[1],S=h("text",1,50,!1),A=Object(m.a)(S,2),G=A[0],R=A[1],F=Object(r.useState)(!1),I=Object(m.a)(F,2),U=I[0],D=I[1],_=function(){var t=Object(i.a)(o.a.mark(function t(a){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),c(!0),a.target.checkValidity()){t.next=4;break}return t.abrupt("return");case 4:return t.prev=4,t.next=7,e.registerUser({username:f.value,password:E.value,name:w.value,email:N.value,city:B.value,country:G.value,hidden:U});case 7:e.setNotification("User registration was succesfull"),e.history.push("/login"),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),e.setNotification("User registration failed","error");case 14:case"end":return t.stop()}},t,null,[[4,11]])}));return function(e){return t.apply(this,arguments)}}();return n.a.createElement(Y.a,{fluid:!0},n.a.createElement(M.a,null,n.a.createElement(W.a,{as:H.a,className:"text-center"},n.a.createElement("h2",null,"Register to Bottlestash"))),n.a.createElement(M.a,{className:"mb-3"},n.a.createElement(H.a,{className:"formstyle"},n.a.createElement(q.a,{noValidate:!0,validated:l,onSubmit:_,id:"registerForm"},n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Username"),n.a.createElement(q.a.Control,Object.assign({},f,{placeholder:"username"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},p)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Password"),n.a.createElement(q.a.Control,Object.assign({},E,{placeholder:"password"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},v)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Name"),n.a.createElement(q.a.Control,Object.assign({},w,{placeholder:"name to show other users"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},x)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Email"),n.a.createElement(q.a.Control,Object.assign({},N,{placeholder:"email"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},j)),n.a.createElement(q.a.Row,null,n.a.createElement(q.a.Group,{as:H.a,className:"p-2"},n.a.createElement(q.a.Label,null,"City"),n.a.createElement(q.a.Control,Object.assign({},B,{placeholder:"(optional)"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},L)),n.a.createElement(q.a.Group,{as:H.a,className:"p-2"},n.a.createElement(q.a.Label,null,"Country"),n.a.createElement(q.a.Control,Object.assign({},G,{placeholder:"(optional)"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},R))),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Check,{type:"checkbox",onChange:function(e){var t=e.target;return D(t.checked)},label:"I want my stash to be private"})),n.a.createElement(J.a,{variant:"success",type:"submit",block:!0},"Register")))))})),de=a(83),be=a(141),Ee={removeBottle:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.remove(e);case 2:a({type:"REMOVE_BOTTLE",id:e});case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},updateBottle:function(e,t){return function(){var a=Object(i.a)(o.a.mark(function a(r){var n;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,I.update(e,t);case 2:n=a.sent,r({type:"UPDATE_BOTTLE",updatedBottle:n});case 4:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},updateUserToState:k,setNotification:D},he=Object(s.b)(null,Ee)(function(e){if(!e.bottle)return null;var t=e.bottle,a=function(){var a=Object(i.a)(o.a.mark(function a(){var r;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,r=Object(de.a)({},t,{beer:t.beer.id,count:t.count-1}),!(t.count<2)){a.next=8;break}return a.next=5,e.removeBottle(t.id);case 5:e.setNotification("This was your last bottle of ".concat(t.beer.name)),a.next=11;break;case 8:return a.next=10,e.updateBottle(t.id,r);case 10:e.setNotification("You drinked one bottle of ".concat(t.beer.brewery.name," ").concat(t.beer.name));case 11:e.updateUserToState(e.user.username),a.next=17;break;case 14:a.prev=14,a.t0=a.catch(0),e.setNotification("Bottle update failed!","error");case 17:case"end":return a.stop()}},a,null,[[0,14]])}));return function(){return a.apply(this,arguments)}}();return n.a.createElement(be.a,{className:"text-center",centered:!0,show:e.visible,onHide:e.toggleVisibility},n.a.createElement(be.a.Header,{closeButton:!0},n.a.createElement(be.a.Title,null,t.beer.name)),n.a.createElement(be.a.Body,null,n.a.createElement("p",null,"Alcohol: ",t.beer.abv," %"),n.a.createElement("p",null,"Brewery: ",t.beer.brewery.name),n.a.createElement("p",null,"Price: ",t.price," \u20ac"),n.a.createElement("p",null,"Volume: ",t.volume," litres"),n.a.createElement("p",null,"Bottled: ",$()(t.bottled).format("DD.MM.YYYY")),n.a.createElement("p",null,"Expires: ",$()(t.expiration).format("DD.MM.YYYY")),n.a.createElement("p",null,"Beers age: ",$()(new Date).diff($()(t.bottled),"months")," months"),n.a.createElement("p",null,"Bottles: ",t.count)),e.user.username===e.userToView.username&&n.a.createElement(be.a.Footer,null,n.a.createElement(V.c,{className:"btn",onClick:a,to:{pathname:"/rate",state:{bottle:t}}},"Drink and rate"),n.a.createElement(J.a,{onClick:a,variant:"light"},"Just drink")))}),ve=function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),l=a[0],c=a[1],s=Object(r.useState)(null),u=Object(m.a)(s,2),o=u[0],i=u[1];if(!e.stash)return null;return n.a.createElement(H.a,{className:"maindiv"},n.a.createElement(X.a,{hover:!0,responsive:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,"Count"),n.a.createElement("th",null,"Brewery"),n.a.createElement("th",null,"Beer"),n.a.createElement("th",null,"Expiration"))),n.a.createElement("tbody",null,e.stash.map(function(e){return n.a.createElement("tr",{key:e.id,onClick:function(){return function(e){i(e),c(!0)}(e)}},n.a.createElement("td",null,e.count),n.a.createElement("td",null,e.beer.brewery.name),n.a.createElement("td",null,e.beer.name,", ",e.beer.abv," %"),n.a.createElement("td",{style:{color:$()(e.expiration).isBefore(new Date)?"red":"black"}},e.expiration?$()(e.expiration).fromNow():"-"))}))),n.a.createElement(he,{user:e.user,userToView:e.userToView,bottle:o,visible:l,toggleVisibility:function(){c(!l)}}))},ge=a(145),ye=function(e){var t=e.stash,a=t.reduce(function(e,t){return e+t.count},0),r=t.reduce(function(e,t){return e+t.price},0),l=t.reduce(function(e,t){return e+t.volume},0);return n.a.createElement(H.a,{className:"maindiv"},n.a.createElement(Q.a,null,n.a.createElement(Q.a.Header,null,n.a.createElement(Q.a.Title,null,"Details of your stash")),n.a.createElement(ge.a,{variant:"flush"},n.a.createElement(ge.a.Item,null,t.length," different beers and ",a," different bottles"),n.a.createElement(ge.a.Item,null,"Your stash costs ",r," \u20ac"),n.a.createElement(ge.a.Item,null,"Your stash has ",l," litres of beer"))))},we=function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),l=a[0],c=a[1];if(!e.userToView)return null;var s=e.userToView.stash;return n.a.createElement(Y.a,{fluid:!0},n.a.createElement(M.a,null,n.a.createElement(W.a,{as:H.a,className:"text-center"},n.a.createElement("h2",null,e.userToView.name," 's Stash"))),e.userToView.username===e.user.username&&e.userToView.hidden&&n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv"},n.a.createElement("p",null,"Your stash is hidden and won't show to other users. If you wan't to make it visible to other users, please update visibility settings in your profile"))),e.userToView.username!==e.user.username&&e.userToView.hidden&&n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv"},n.a.createElement("p",null,"This stash is private and cannot be peeked - sorry!"))),e.userToView.username===e.user.username&&n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"d-flex justify-content-center mb-4"},n.a.createElement(le.a,null,n.a.createElement(le.a.Link,{onClick:function(){return c(!l)},className:"p-2"},l?"Back to stash":"Stash details"),n.a.createElement(le.a.Link,{as:"span",className:"p-2"},n.a.createElement(V.c,{to:"/bottles"},"Add new bottle"))))),(e.userToView.username===e.user.username||!e.userToView.hidden)&&n.a.createElement(M.a,{className:"mb-3"},l?n.a.createElement(ye,{stash:s}):n.a.createElement(ve,{stash:s,user:e.user,userToView:e.userToView})))},xe=function(e){return n.a.createElement(W.a,{className:"mt-5",style:{backgroundColor:"whitesmoke",color:"black"}},n.a.createElement(M.a,null,n.a.createElement(H.a,null,n.a.createElement(le.a,{className:"justify-content-center"},n.a.createElement(le.a.Link,{as:"span"},n.a.createElement(V.c,{to:"/"},"Home")),n.a.createElement(le.a.Link,{as:"span"},n.a.createElement(V.c,{to:"/about"},"About")),n.a.createElement(le.a.Link,{href:"https://github.com/MiguelSombrero/bottlestash-app-backend"},"Github")))),n.a.createElement(M.a,{className:"mt-4"},n.a.createElement(H.a,{className:"text-center"},n.a.createElement("p",null,"\xa9 Miika Somero 2019"))))},Oe=E("/api/pictures"),ke=function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(r=new FormData).append("picture",e),t.next=4,Oe.createImage(r);case 4:return n=t.sent,t.abrupt("return",n);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},Ne={addBeer:A,addBrewery:T,addBottle:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.create(e);case 2:r=t.sent,a({type:"ADD_BOTTLE",newBottle:r});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},addPicture:ke,getOneBeer:S,getOneBrewery:C,updateUserToState:k},je=Object(s.b)(null,Ne)(Object(P.e)(function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),l=a[0],c=a[1],s=Object(r.useState)(!1),u=Object(m.a)(s,2),f=u[0],p=u[1],d=Object(r.useState)(null),b=Object(m.a)(d,2),E=b[0],g=b[1],y=h("text",1,50,!0),w=Object(m.a)(y,2),x=w[0],O=w[1],k=h("text",1,50,!0),N=Object(m.a)(k,2),j=N[0],C=N[1],T=v("number",0,100,.1,!0),B=Object(m.a)(T,2),L=B[0],S=B[1],A=v("number",0,1e3,.01),G=Object(m.a)(A,2),R=G[0],F=G[1],I=v("number",0,50,1,!0),U=Object(m.a)(I,2),D=U[0],_=U[1],V=v("number",0,10,.001),P=Object(m.a)(V,2),z=P[0],K=P[1],Q=v("date","1990-01-01","2050-01-01",1),X=Object(m.a)(Q,2),Z=X[0],$=X[1],ee=v("date","1990-01-01","2050-01-01",1),te=Object(m.a)(ee,2),ae=te[0],re=te[1],ne=function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n,l,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),c(!0),a.target.checkValidity()){t.next=4;break}return t.abrupt("return");case 4:return p(!0),t.prev=5,t.next=8,e.getOneBrewery(x.value);case 8:if(r=t.sent){t.next=13;break}return t.next=12,e.addBrewery({name:x.value});case 12:r=t.sent;case 13:return t.next=15,e.getOneBeer(r.id,j.value,L.value);case 15:if(n=t.sent){t.next=20;break}return t.next=19,e.addBeer({breweryId:r.id,name:j.value,abv:L.value});case 19:n=t.sent;case 20:if(!E){t.next=26;break}return t.next=23,e.addPicture(E);case 23:t.t0=t.sent,t.next=27;break;case 26:t.t0=null;case 27:return l=t.t0,t.next=30,e.addBottle({price:R.value,count:D.value,volume:z.value,bottled:Z.value,expiration:ae.value,beerId:n.id,pictureId:l?l.id:null});case 30:return t.next=32,e.updateUserToState(e.user.username);case 32:s=t.sent,p(!1),e.setNotification("Added bottle succesfully"),e.history.push("/users/".concat(s.id,"/stash")),t.next=41;break;case 38:t.prev=38,t.t1=t.catch(5),e.setNotification("Adding bottle failed - sorry!","error");case 41:case"end":return t.stop()}},t,null,[[5,38]])}));return function(e){return t.apply(this,arguments)}}();return n.a.createElement(Y.a,{fluid:!0},n.a.createElement(M.a,null,n.a.createElement(W.a,{as:H.a,className:"text-center"},n.a.createElement("h2",null,"Add new bottle to your stash"))),n.a.createElement(M.a,{className:"mb-3"},n.a.createElement(H.a,{className:"formstyle"},n.a.createElement(q.a,{noValidate:!0,validated:l,onSubmit:ne,id:"addBottleForm"},n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Brewery"),n.a.createElement(q.a.Control,Object.assign({},x,{list:"breweriesAsList",placeholder:"name of the brewery"})),n.a.createElement(ue,{suggestions:e.breweries?e.breweries.map(function(e){return e.name}):null,id:"breweriesAsList"}),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},O)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Name"),n.a.createElement(q.a.Control,Object.assign({},j,{list:"beersAsList",placeholder:"name of your beer"})),n.a.createElement(ue,{suggestions:e.beers?e.beers.filter(function(e){return e.brewery.name===x.value}).map(function(e){return e.name}):null,id:"beersAsList"}),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},C)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Abv"),n.a.createElement(q.a.Control,Object.assign({},L,{list:"abvAsList",placeholder:"alcohol %"})),n.a.createElement(ue,{suggestions:e.beers?e.beers.filter(function(e){return e.brewery.name===x.value&&e.name===j.value}).map(function(e){return e.abv}):null,id:"abvAsList"}),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},S)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Count"),n.a.createElement(q.a.Control,Object.assign({},D,{placeholder:"number of bottles to save"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},_)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Volume"),n.a.createElement(q.a.Control,Object.assign({},z,{placeholder:"volume of the bottle in litres"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},K)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Price"),n.a.createElement(q.a.Control,Object.assign({},R,{placeholder:"price of an one bottle"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},F)),n.a.createElement(q.a.Row,null,n.a.createElement(q.a.Group,{as:H.a,className:"p-2"},n.a.createElement(q.a.Label,null,"Bottled"),n.a.createElement(q.a.Control,Object.assign({},Z,{placeholder:"day beer was bottled"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},$)),n.a.createElement(q.a.Group,{as:H.a,className:"p-2"},n.a.createElement(q.a.Label,null,"Expiration"),n.a.createElement(q.a.Control,Object.assign({},ae,{placeholder:"expiration day of bottles"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},re))),n.a.createElement(q.a.Group,{className:"custom-file mb-4 p-2"},n.a.createElement(q.a.Label,{className:"custom-file-label"},"Click to add pic of your bottle"),n.a.createElement(q.a.Control,{name:"picture",className:"custom-file-input",type:"file",accept:"image/*",onChange:function(e){var t=e.target;return g(t.files[0])}}),E&&n.a.createElement(q.a.Text,{className:"text-center"},E.name)),n.a.createElement(J.a,{variant:"success",type:"submit",block:!0,disabled:f}," ",f?"Loading ...":"Add beer")))))})),Ce=a(139),Te=Object(s.b)(function(e){return{notification:e.notification}})(function(e){return e.notification?n.a.createElement(M.a,{className:"notification"},n.a.createElement(Ce.a,{as:H.a,className:"text-center col-12",variant:"success"===e.notification.type?"success":"danger"},e.notification.message)):null}),Be={addBeer:A,getOneBeer:S,addBrewery:T,getOneBrewery:C,addRating:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.create(e);case 2:r=t.sent,a({type:"ADD_RATING",rating:r});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},addPicture:ke,setNotification:D},Le=Object(s.b)(null,Be)(Object(P.e)(function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),l=a[0],c=a[1],s=Object(r.useState)(null),u=Object(m.a)(s,2),f=u[0],p=u[1],d=h("text",1,50,!0),b=Object(m.a)(d,3),E=b[0],g=b[1],y=b[2],w=h("text",1,50,!0),x=Object(m.a)(w,3),O=x[0],k=x[1],N=x[2],j=h("text",0,1e3,!1),C=Object(m.a)(j,2),T=C[0],B=C[1],L=v("number",0,100,.1,!0),S=Object(m.a)(L,3),A=S[0],G=S[1],R=S[2],F=v("date","1990-01-01","2050-01-01",1,!1),I=Object(m.a)(F,3),U=I[0],D=I[1],_=I[2],V=v("range",1,10,1,!0),P=Object(m.a)(V,3),z=P[0],K=P[2],Q=v("range",1,10,1,!0),X=Object(m.a)(Q,3),Z=X[0],ee=X[2],te=v("range",1,5,1,!0),ae=Object(m.a)(te,3),re=ae[0],ne=ae[2],le=v("range",1,5,1,!0),ce=Object(m.a)(le,3),se=ce[0],ue=ce[2],oe=v("range",1,20,1,!0),ie=Object(m.a)(oe,3),me=ie[0],fe=ie[2];Object(r.useEffect)(function(){if(e.location.state){var t=e.location.state.bottle;y(t.beer.name),N(t.beer.brewery.name),R(t.beer.abv),t.bottled&&_($()(t.bottled).format("YYYY-MM-DD"))}K(1),ee(1),ue(1),ne(1),fe(1)},[]);var pe=function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n,l,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),c(!0),a.target.checkValidity()){t.next=4;break}return t.abrupt("return");case 4:if(t.prev=4,r=null,e.beer){t.next=21;break}return t.next=9,e.getOneBrewery(O.value);case 9:if(n=t.sent){t.next=14;break}return t.next=13,e.addBrewery({name:O.value});case 13:n=t.sent;case 14:return t.next=16,e.getOneBeer(n.id,E.value,A.value);case 16:if(r=t.sent){t.next=21;break}return t.next=20,e.addBeer({breweryId:n.id,name:E.value,abv:A.value});case 20:r=t.sent;case 21:if(!f){t.next=27;break}return t.next=24,e.addPicture(f);case 24:t.t0=t.sent,t.next=28;break;case 27:t.t0=null;case 28:l=t.t0,s={beerId:void 0===e.beer?r.id:e.beer.id,description:T.value,ageofbeer:U?$()(new Date).diff($()(U.value),"months"):null,aroma:z.value,taste:Z.value,appearance:re.value,mouthfeel:se.value,overall:me.value,pictureId:l?l.id:null},e.addRating(s),e.setNotification("New rating added!"),e.history.push("/"),t.next=38;break;case 35:t.prev=35,t.t1=t.catch(4),e.setNotification("Adding a new rating failed!","error");case 38:case"end":return t.stop()}},t,null,[[4,35]])}));return function(e){return t.apply(this,arguments)}}();return n.a.createElement(Y.a,{fluid:!0},n.a.createElement(M.a,null,n.a.createElement(W.a,{as:H.a,className:"text-center mb-2"},n.a.createElement("h2",null,"Rate beer"))),n.a.createElement(M.a,{className:"mb-3"},n.a.createElement(H.a,{style:{maxWidth:"25rem",margin:"auto"}},n.a.createElement(q.a,{noValidate:!0,validated:l,onSubmit:pe,id:"rateForm"},n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Brewery"),n.a.createElement(q.a.Control,Object.assign({},O,{placeholder:"name of brewery"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},k)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Beer"),n.a.createElement(q.a.Control,Object.assign({},E,{placeholder:"name of beer"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},g)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Abv"),n.a.createElement(q.a.Control,Object.assign({},A,{placeholder:"alcohol volume"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},G)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Bottled"),n.a.createElement(q.a.Control,Object.assign({},U,{placeholder:"(optional)"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},D)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Aroma"),n.a.createElement(q.a.Text,null,z.value),n.a.createElement(q.a.Control,z)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Taste"),n.a.createElement(q.a.Text,null,Z.value),n.a.createElement(q.a.Control,Z)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Appearance"),n.a.createElement(q.a.Text,null,re.value),n.a.createElement(q.a.Control,re)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Mouthfeel"),n.a.createElement(q.a.Text,null,se.value),n.a.createElement(q.a.Control,se)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Overall"),n.a.createElement(q.a.Text,null,me.value),n.a.createElement(q.a.Control,me)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Description"),n.a.createElement(q.a.Control,Object.assign({as:"textarea",rows:"4"},T,{placeholder:"describe your beer"})),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},B)),n.a.createElement(q.a.Group,{className:"custom-file mb-4 p-2"},n.a.createElement(q.a.Label,{className:"custom-file-label"},"Click to add pic of your beer"),n.a.createElement(q.a.Control,{name:"picture",className:"custom-file-input",type:"file",accept:"image/*",onChange:function(e){var t=e.target;return p(t.files[0])}}),f&&n.a.createElement(q.a.Text,{className:"text-center"},f.name)),n.a.createElement(J.a,{type:"submit",variant:"success",block:!0},"Add rating")))))})),Se={removeUser:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.remove(e);case 2:a({type:"REMOVE_USER",id:e});case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},updateUser:function(e,t){return function(){var a=Object(i.a)(o.a.mark(function a(r){var n;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,O.update(e,t);case 2:n=a.sent,r({type:"UPDATE_USER",updatedUser:n});case 4:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},logoutUser:y,addPicture:ke,setNotification:D},Ae=Object(s.b)(null,Se)(Object(P.e)(function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),l=a[0],c=a[1],s=Object(r.useState)(null),u=Object(m.a)(s,2),f=u[0],p=u[1],d=h("text",1,20,!0),b=Object(m.a)(d,3),E=b[0],v=b[1],g=b[2],y=h("text",1,50,!0),w=Object(m.a)(y,3),x=w[0],O=w[1],k=w[2],N=h("text",1,50,!1),j=Object(m.a)(N,3),C=j[0],T=j[1],B=j[2],L=h("text",1,20,!1),S=Object(m.a)(L,3),A=S[0],G=S[1],R=S[2],F=Object(r.useState)(!1),I=Object(m.a)(F,2),U=I[0],D=I[1];if(Object(r.useEffect)(function(){g(e.user.name||""),k(e.user.email||""),B(e.user.city||""),R(e.user.country||""),D(e.user.hidden)},[]),!e.user)return null;var _=function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),c(!0),a.target.checkValidity()){t.next=4;break}return t.abrupt("return");case 4:if(t.prev=4,!f){t.next=11;break}return t.next=8,e.addPicture(f);case 8:t.t0=t.sent,t.next=12;break;case 11:t.t0=null;case 12:return r=t.t0,n={name:E.value,email:x.value,city:C.value,country:A.value,pictureId:r?r.id:null,hidden:U},t.next=16,e.updateUser(e.user.id,n);case 16:e.setNotification("Profile saved!"),t.next=22;break;case 19:t.prev=19,t.t1=t.catch(4),e.setNotification("Saving profile failed!","error");case 22:case"end":return t.stop()}},t,null,[[4,19]])}));return function(e){return t.apply(this,arguments)}}(),P=function(){var t=Object(i.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.confirm("Are you sure you want to delete your profile and all its data?")){t.next=13;break}return t.prev=1,t.next=4,e.removeUser(e.user.id);case 4:return t.next=6,e.logoutUser();case 6:e.setNotification("Your profile and data has been deleted"),e.history.push("/"),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),e.setNotification("Removing yor profile failed!","error");case 13:case"end":return t.stop()}},t,null,[[1,10]])}));return function(){return t.apply(this,arguments)}}();return n.a.createElement(Y.a,{fluid:!0},n.a.createElement(M.a,null,n.a.createElement(W.a,{as:H.a,className:"text-center mb-2"},n.a.createElement("h2",null,e.user.username," profile"))),n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"d-flex justify-content-center mb-4"},n.a.createElement(le.a,null,n.a.createElement(le.a.Link,{as:"span",className:"p-2"},n.a.createElement(V.c,{to:"/users/".concat(e.user.id,"/stash")},"Your stash")),n.a.createElement(le.a.Link,{as:"span",className:"p-2"},n.a.createElement(V.c,{to:"/users/".concat(e.user.id,"/ratings")},"Your ratings")),n.a.createElement(le.a.Link,{onClick:P,className:"p-2"},"Delete profile")))),n.a.createElement(M.a,{className:"mb-3"},n.a.createElement(H.a,null,n.a.createElement(q.a,{noValidate:!0,validated:l,style:{maxWidth:"25rem",margin:"auto"},onSubmit:_,id:"profileUpdateForm"},n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Name"),n.a.createElement(q.a.Control,E),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},v)),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Label,null,"Email"),n.a.createElement(q.a.Control,x),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},O)),n.a.createElement(q.a.Row,null,n.a.createElement(q.a.Group,{style:{maxWidth:"50%"},className:"p-2"},n.a.createElement(q.a.Label,null,"City"),n.a.createElement(q.a.Control,C),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},T)),n.a.createElement(q.a.Group,{style:{maxWidth:"50%"},className:"p-2"},n.a.createElement(q.a.Label,null,"Country"),n.a.createElement(q.a.Control,A),n.a.createElement(q.a.Control.Feedback,{type:"invalid"},G))),n.a.createElement(q.a.Group,null,n.a.createElement(q.a.Check,{type:"checkbox",checked:U,onChange:function(e){var t=e.target;return D(t.checked)},label:"I want my stash to be private"})),n.a.createElement(q.a.Group,{className:"custom-file mb-4 p-2"},n.a.createElement(q.a.Label,{className:"custom-file-label"},"Click to add profile picture"),n.a.createElement(q.a.Control,{name:"picture",className:"custom-file-input",type:"file",accept:"image/*",onChange:function(e){var t=e.target;return p(t.files[0])}}),f&&n.a.createElement(q.a.Text,{className:"text-center"},f.name)),n.a.createElement(J.a,{type:"submit",variant:"success",block:!0},"Save profile")))))})),Ge={setFilter:ce},Re=Object(s.b)(function(e){return{filter:e.filter,bottles:e.bottles,beers:e.beers,breweries:e.breweries}},Ge)(function(e){var t=function(t){return!!e.filter&&t.name.toLowerCase().includes(e.filter.toLowerCase())},a=function(t){return!!e.filter&&t.name.toLowerCase().includes(e.filter.toLowerCase())},r=e.bottles?e.bottles.filter(function(e){return!e.user.hidden}).filter(function(e){return t(e.beer)||a(e.beer.brewery)}):null,l=e.beers?e.beers.filter(t):null,c=e.breweries?e.breweries.filter(a):null;return n.a.createElement(Y.a,{fluid:!0},n.a.createElement(M.a,null,n.a.createElement(W.a,{as:H.a,className:"text-center"},n.a.createElement("h2",null,"Search from Bottlestash"))),n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv d-flex justify-content-center mb-5"},n.a.createElement(oe,{handleSearch:function(t){t.preventDefault(),e.setFilter(t.target.filter.value),t.target.filter.value=""},id:"search"}))),e.filter&&n.a.createElement(n.a.Fragment,null,r.length>0?n.a.createElement(n.a.Fragment,null,n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"text-center"},n.a.createElement("h3",null,"Bottles"),n.a.createElement("p",null,r.length," bottles for search '",e.filter,"'"))),n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv"},n.a.createElement(ge.a,{variant:"flush"},r.map(function(e){return n.a.createElement(ge.a.Item,{key:e.id},e.beer.name," ",e.beer.abv," %, ",e.beer.brewery.name," ",n.a.createElement(V.c,{to:"users/".concat(e.user.id,"/stash")},"in ",e.user.name," stash"))}))))):n.a.createElement("p",{className:"text-center"},"No bottles for search '",e.filter,"'"),l.length>0?n.a.createElement(n.a.Fragment,null,n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"text-center"},n.a.createElement("h3",null,"Beers"),n.a.createElement("p",null,l.length," beers for search '",e.filter,"'"))),n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv"},n.a.createElement(ge.a,{variant:"flush"},l.map(function(e){return n.a.createElement(ge.a.Item,{key:e.id},n.a.createElement(V.c,{to:"/beers/".concat(e.id)},e.name," ",e.abv," %"),", beer by ",e.brewery.name)}))))):n.a.createElement("p",{className:"text-center"},"No beers for search '",e.filter,"'"),c.length>0?n.a.createElement(n.a.Fragment,null,n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"text-center"},n.a.createElement("h3",null,"Breweries"),n.a.createElement("p",null,c.length," breweries for search '",e.filter,"'"))),n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv"},n.a.createElement(ge.a,{variant:"flush"},c.map(function(e){return n.a.createElement(ge.a.Item,{key:e.id},n.a.createElement(V.c,{to:"/breweries/".concat(e.id)},e.name))}))))):n.a.createElement("p",{className:"text-center"},"No breweries for search '",e.filter,"'")))}),Fe=function(e){var t=e.brewery;return t?n.a.createElement(Y.a,{fluid:!0},n.a.createElement(M.a,null,n.a.createElement(W.a,{as:H.a,className:"text-center"},n.a.createElement("h2",null,t.name))),n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"text-center"},n.a.createElement("h3",null,"Beers"))),n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv"},n.a.createElement(ge.a,{variant:"flush"},t.beers.map(function(e){return n.a.createElement(ge.a.Item,{key:e.id},n.a.createElement(V.c,{to:"/beers/".concat(e.id)},e.name," ",e.abv," %"))}))))):null},Ie=function(e){var t=e.beer,a=e.ratings;if(!t)return null;var r=a.filter(function(e){return e.beer.id===t.id});return n.a.createElement(Y.a,{fluid:!0},n.a.createElement(M.a,null,n.a.createElement(W.a,{as:H.a,className:"text-center"},n.a.createElement("h2",null,t.name," ",t.abv," %"),n.a.createElement("h5",null,t.brewery.name))),r.length>0?n.a.createElement(n.a.Fragment,null,n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"text-center"},n.a.createElement("h3",null,"Ratings"))),n.a.createElement(ae,{resources:r,resource:"rating"})):n.a.createElement("h4",{className:"text-center"},"No ratings for this beer"))},Ue=function(){return n.a.createElement(Y.a,{fluid:!0},n.a.createElement(M.a,null,n.a.createElement(W.a,{as:H.a,className:"text-center"},n.a.createElement("h2",null,"About Bottlestash"))),n.a.createElement(M.a,null,n.a.createElement(H.a,{className:"maindiv"},n.a.createElement("p",null,"Bottlestash is my (Miika Somero) course project for University of Helsinki course ",n.a.createElement("a",{href:"https://fullstackopen.com/"},"Full Stack Open 2019"),"."),n.a.createElement("p",null,"Project is about rehearsing web development with React and Node.js. See source code and documentation from my ",n.a.createElement("a",{href:"https://github.com/MiguelSombrero/bottlestash-app-backend"},"Github")," page"))))},De=Object(P.e)(function(e){var t=e.children,a=e.location.pathname;return Object(r.useEffect)(function(){window.scrollTo(0,0)},[a]),t||null}),_e=(a(131),{setUserToState:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:b(e.token),a({type:"LOGIN",user:e});case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},getAllUsers:function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.getAll();case 2:a=e.sent,t({type:"GET_USERS",users:a});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},getAllBreweries:function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getAll();case 2:a=e.sent,t({type:"GET_BREWERIES",breweries:a});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},getAllBeers:function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.getAll();case 2:a=e.sent,t({type:"GET_BEERS",beers:a});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},getAllRatings:function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.getAll();case 2:a=e.sent,t({type:"GET_RATINGS",ratings:a});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},getAllBottles:function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getAll();case 2:a=e.sent,t({type:"GET_BOTTLES",bottles:a});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},setNotification:D}),Ve=Object(s.b)(function(e){return{user:e.user,users:e.users,breweries:e.breweries,beers:e.beers,bottles:e.bottles,ratings:e.ratings}},_e)(function(e){Object(r.useEffect)(function(){var t=window.localStorage.getItem("loggedBottlestashUser");t&&e.setUserToState(JSON.parse(t))},[]),Object(r.useEffect)(function(){e.getAllUsers()},[]),Object(r.useEffect)(function(){e.getAllBreweries()},[]),Object(r.useEffect)(function(){e.getAllBeers()},[]),Object(r.useEffect)(function(){e.getAllRatings()},[]),Object(r.useEffect)(function(){e.getAllBottles()},[]);var t=function(){return e.user?e.users.find(function(t){return t.username===e.user.username}):null};return n.a.createElement(n.a.Fragment,null,n.a.createElement(V.a,null,n.a.createElement(De,null),n.a.createElement(me,{user:t(),setNotification:e.setNotification}),n.a.createElement(Te,null),n.a.createElement(P.a,{exact:!0,path:"/",render:function(){return n.a.createElement(re,{user:e.user,bottles:e.bottles,ratings:e.ratings})}}),n.a.createElement(P.a,{exact:!0,path:"/login",render:function(){return n.a.createElement(K,{setNotification:e.setNotification})}}),n.a.createElement(P.a,{exact:!0,path:"/register",render:function(){return n.a.createElement(pe,{setNotification:e.setNotification})}}),n.a.createElement(P.a,{exact:!0,path:"/about",render:function(){return n.a.createElement(Ue,null)}}),n.a.createElement(P.a,{exact:!0,path:"/search",render:function(){return n.a.createElement(Re,{user:e.user})}}),n.a.createElement(P.a,{exact:!0,path:"/breweries/:id/",render:function(t){var a,r=t.match;return n.a.createElement(Fe,{brewery:(a=r.params.id,e.breweries.find(function(e){return e.id===a}))})}}),n.a.createElement(P.a,{exact:!0,path:"/beers/:id/",render:function(t){var a,r=t.match;return n.a.createElement(Ie,{beer:(a=r.params.id,e.beers.find(function(e){return e.id===a})),ratings:e.ratings})}}),e.user&&n.a.createElement(n.a.Fragment,null,n.a.createElement(P.a,{exact:!0,path:"/bottles",render:function(){return n.a.createElement(je,{breweries:e.breweries,beers:e.beers,user:e.user,setNotification:e.setNotification})}}),n.a.createElement(P.a,{exact:!0,path:"/users/:id/ratings",render:function(t){var a,r=t.match;return n.a.createElement(ae,{resources:(a=r.params.id,e.ratings.filter(function(e){return e.user.id===a})),resource:"rating"})}}),n.a.createElement(P.a,{exact:!0,path:"/rate",render:function(e){return n.a.createElement(Le,e)}}),t()&&n.a.createElement(P.a,{exact:!0,path:"/profile",render:function(){return n.a.createElement(Ae,{setNotification:e.setNotification,user:t()})}}),n.a.createElement(P.a,{exact:!0,path:"/users/:id/stash",render:function(t){var a,r=t.match;return n.a.createElement(we,{userToView:(a=r.params.id,e.users.find(function(e){return e.id===a})),user:e.user})}})),n.a.createElement(xe,null)))}),Pe=a(37),Ye=a(82),Me=Object(Pe.c)({user:w,users:N,beers:G,breweries:B,notification:_,ratings:F,bottles:U,filter:se}),We=Object(Pe.d)(Me,Object(Pe.a)(Ye.a));c.a.render(n.a.createElement(s.a,{store:We},n.a.createElement(Ve,null)),document.getElementById("root"))},84:function(e,t,a){e.exports=a(132)}},[[84,1,2]]]);
//# sourceMappingURL=main.e8f64ac9.chunk.js.map