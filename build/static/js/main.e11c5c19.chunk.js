(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{131:function(e,t,a){},132:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(21),l=a.n(c),s=a(10),u=a(2),o=a.n(u),i=a(7),m=a(6),f=a(32),d=a.n(f),p=null,E=function(e){p="bearer ".concat(e)},b=function(e){var t=function(){var t=Object(i.a)(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.get(e);case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),a=function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.get("".concat(e,"/").concat(a));case 2:return r=t.sent,t.abrupt("return",r.data);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),r=function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={headers:{Authorization:p}},t.next=3,d.a.post(e,a,r);case 3:return n=t.sent,t.abrupt("return",n.data);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),n=function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.post(e,a);case 2:return r=t.sent,t.abrupt("return",r.data);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return{create:r,createImage:function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={headers:{Authorization:p,"content-type":"multipart/form-data"}},t.next=3,d.a.post(e,a,r);case 3:return n=t.sent,t.abrupt("return",n.data);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getAll:t,getOne:a,update:function(){var t=Object(i.a)(o.a.mark(function t(a,r){var n,c;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={headers:{Authorization:p}},t.next=3,d.a.put("".concat(e,"/").concat(a),r,n);case 3:return c=t.sent,t.abrupt("return",c.data);case 5:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}(),remove:function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={headers:{Authorization:p}},t.next=3,d.a.delete("".concat(e,"/").concat(a),r);case 3:return n=t.sent,t.abrupt("return",n.data);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),login:n}},h=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=Object(r.useState)(""),l=Object(m.a)(c,2),s=l[0],u=l[1],o=Object(r.useState)(""),i=Object(m.a)(o,2),f=i[0],d=i[1];return[{type:e,minLength:t,maxLength:a,required:n,value:s,onChange:function(e){u(e.target.value)},onInvalid:function(e){d(e.target.validationMessage)}},f,function(e){u(e)}]},v=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=Object(r.useState)(""),s=Object(m.a)(l,2),u=s[0],o=s[1],i=Object(r.useState)(""),f=Object(m.a)(i,2),d=f[0],p=f[1];return[{type:e,min:t,max:a,step:n,required:c,value:u,onChange:function(e){o(e.target.value)},onInvalid:function(e){p(e.target.validationMessage)}},d,function(e){o(e)}]},g=b("/api/login"),w=function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedBottlestashUser"),E(null),t({type:"LOGOUT"});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.user;case"LOGOUT":return null;default:return e}},x=a(18),O=b("/api/users"),N=function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.getOne(e);case 2:return r=t.sent,a({type:"UPDATE_USER_TO_STATE",user:r}),t.abrupt("return",r);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USERS":return t.users;case"UPDATE_USER_TO_STATE":return e.map(function(e){return e.id!==t.user.id?e:t.user});case"REMOVE_USER":return e.filter(function(e){return e.id!==t.id});case"UPDATE_USER":return e.map(function(e){return e.id===t.updatedUser.id?t.updatedUser:e});case"REGISTER_USER":return[].concat(Object(x.a)(e),[t.newUser]);default:return e}},j=b("/api/breweries"),T=function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.getOne(e);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},B=function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.create(e);case 2:return r=t.sent,a({type:"ADD_BREWERY",brewery:r}),t.abrupt("return",r);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_BREWERIES":return t.breweries;case"ADD_BREWERY":return[].concat(Object(x.a)(e),[t.brewery]);default:return e}},R=b("/api/beers"),A=function(e,t,a){return function(){var r=Object(i.a)(o.a.mark(function r(n){var c;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,R.getOne("".concat(e,"/").concat(t,"/").concat(a));case 2:return c=r.sent,r.abrupt("return",c);case 4:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}()},I=function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.create(e);case 2:return r=t.sent,a({type:"ADD_BEER",beer:r}),t.abrupt("return",r);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_BEERS":return t.beers;case"ADD_BEER":return[].concat(Object(x.a)(e),[t.beer]);default:return e}},C=b("/api/ratings"),U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_RATINGS":return t.ratings;case"ADD_RATING":return[].concat(Object(x.a)(e),[t.rating]);default:return e}},D=b("/api/bottles"),_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_BOTTLES":return t.bottles;case"ADD_BOTTLE":return[].concat(Object(x.a)(e),[t.newBottle]);case"REMOVE_BOTTLE":return e.filter(function(e){return e.id!==t.id});case"UPDATE_BOTTLE":return e.map(function(e){return e.id===t.updatedBottle.id?t.updatedBottle:e});default:return e}},F=a(8),V=a(30),G=a(134),P=a(135),Y=a(136),M=a(78),W=a(141),H=a(137),q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";return function(){var a=Object(i.a)(o.a.mark(function a(r){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:r({type:"SET_NOTIFICATION",notification:{message:e,type:t}}),setTimeout(function(){r({type:"CLEAR_NOTIFICATION"})},4e3);case 2:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.notification;case"CLEAR_NOTIFICATION":return null;default:return e}},z=function(e){var t=Object(x.a)(new Set(e.suggestions));return n.a.createElement("datalist",{id:e.id},t.map(function(e){return n.a.createElement("option",{key:e,value:e})}))},K=function(e){return n.a.createElement(W.a.Group,null,n.a.createElement(W.a.Label,null,e.name),n.a.createElement(W.a.Control,Object.assign({},e.state,{placeholder:e.placeholder,list:e.name})),n.a.createElement(z,{suggestions:e.suggestions,id:e.name}),n.a.createElement(W.a.Control.Feedback,{type:"invalid"},e.errors))},Q={loginUser:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.login(e);case 2:r=t.sent,window.localStorage.setItem("loggedBottlestashUser",JSON.stringify(r)),E(r.token),a({type:"LOGIN",user:r});case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},setNotification:q},X=Object(s.b)(null,Q)(Object(V.e)(function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),c=a[0],l=a[1],s=h("text",5,20,!0),u=Object(m.a)(s,2),f=u[0],d=u[1],p=h("password",5,20,!0),E=Object(m.a)(p,2),b=E[0],v=E[1],g=function(){var t=Object(i.a)(o.a.mark(function t(a){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),a.target.checkValidity()){t.next=4;break}return l(!0),t.abrupt("return");case 4:return t.prev=4,t.next=7,e.loginUser({username:f.value,password:b.value});case 7:e.history.push("/"),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(4),e.setNotification("Login failed","error");case 13:case"end":return t.stop()}},t,null,[[4,10]])}));return function(e){return t.apply(this,arguments)}}();return n.a.createElement(G.a,{fluid:!0},n.a.createElement(P.a,null,n.a.createElement(Y.a,{as:M.a,className:"text-center"},n.a.createElement("h2",null,"Login to Bottlestash"))),n.a.createElement(P.a,{id:"loginForm"},n.a.createElement(M.a,{className:"formstyle"},n.a.createElement(W.a,{noValidate:!0,validated:c,onSubmit:g},n.a.createElement(K,{name:"Username",state:f,placeholder:"username",errors:d}),n.a.createElement(K,{name:"Password",state:b,placeholder:"password",errors:v}),n.a.createElement(H.a,{id:"login",variant:"success",type:"submit",block:!0},"Login")),n.a.createElement(P.a,{className:"mt-2"},n.a.createElement(M.a,{className:"text-center"},n.a.createElement("small",null,"Not yet a member?",n.a.createElement(F.b,{to:"/register"}," Register here")))))))})),Z=a(146),$=a(145),ee=a(138),te=a(139),ae=a(15),re=a.n(ae),ne=function(e){var t=e.rating;return n.a.createElement($.a,{className:"text-center p-2 m-2"},n.a.createElement($.a.Header,{style:{backgroundColor:"white",color:"rgb(52, 58, 64)"}},n.a.createElement($.a.Title,null,n.a.createElement(F.c,{to:"/beers/".concat(t.beer.id)},t.beer.name," ",t.beer.abv," %")),n.a.createElement(P.a,null,n.a.createElement(M.a,null,n.a.createElement("small",null,"brewery: ",n.a.createElement(F.c,{to:"/breweries/".concat(t.beer.brewery.id)},t.beer.brewery.name)))),n.a.createElement(P.a,null,n.a.createElement(M.a,null,t.ageofbeer&&n.a.createElement("small",null,"rated: ",t.ageofbeer," months age")))),n.a.createElement(ee.a,{responsive:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,n.a.createElement("small",{className:"text-muted"},"aroma")),n.a.createElement("th",null,n.a.createElement("small",{className:"text-muted"},"taste")),n.a.createElement("th",null,n.a.createElement("small",{className:"text-muted"},"mouthfeel")),n.a.createElement("th",null,n.a.createElement("small",{className:"text-muted"},"appearance")),n.a.createElement("th",null,n.a.createElement("small",{className:"text-muted"},"overall")),n.a.createElement("th",null,n.a.createElement("small",null,"score")))),n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("small",{className:"text-muted"},t.aroma,"/10")),n.a.createElement("td",null,n.a.createElement("small",{className:"text-muted"},t.taste,"/10")),n.a.createElement("td",null,n.a.createElement("small",{className:"text-muted"},t.mouthfeel,"/5")),n.a.createElement("td",null,n.a.createElement("small",{className:"text-muted"},t.appearance,"/5")),n.a.createElement("td",null,n.a.createElement("small",{className:"text-muted"},t.overall,"/20")),n.a.createElement("td",null,n.a.createElement(te.a,{variant:"warning"},t.overall+t.aroma+t.taste+t.mouthfeel+t.appearance,"/50"))))),n.a.createElement($.a.Body,null,t.picture&&n.a.createElement($.a.Img,{src:"/api/pictures/".concat(t.picture),className:"img-thumbnail",alt:""}),n.a.createElement("blockquote",{className:"blockquote mt-2"},t.description),n.a.createElement("footer",{className:"blockquote-footer"}," ",n.a.createElement("cite",null,t.user.name))),n.a.createElement($.a.Footer,null,n.a.createElement("small",{className:"text-muted"},"by ",n.a.createElement(F.c,{to:"/users/".concat(t.user.id,"/stash")},t.user.name),", ",re()(t.added).fromNow())))},ce=function(e){var t=e.bottle;return t?n.a.createElement($.a,{className:"p-2 m-2 text-center"},n.a.createElement($.a.Header,{style:{backgroundColor:"white",color:"rgb(52, 58, 64)"}},n.a.createElement($.a.Title,null,n.a.createElement(F.c,{to:"/beers/".concat(t.beer.id)},t.beer.name," ",t.beer.abv," %")),n.a.createElement("small",{className:"text-left"},"brewery: ",n.a.createElement(F.c,{to:"/breweries/".concat(t.beer.brewery.id)},t.beer.brewery.name))),t.picture&&n.a.createElement($.a.Body,null,n.a.createElement($.a.Img,{src:"/api/pictures/".concat(t.picture),className:"img-thumbnail",alt:""})),n.a.createElement($.a.Footer,null,n.a.createElement("small",{className:"text-muted"},"added by ",n.a.createElement(F.c,{to:"/users/".concat(t.user.id,"/stash")},t.user.name),", ",re()(t.added).fromNow()))):null},le=function(e){var t=Object(r.useState)(5),a=Object(m.a)(t,2),c=a[0],l=a[1],s=e.resources.slice(0,c);return n.a.createElement(n.a.Fragment,null,n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv"},s.map(function(t){return"rating"===e.resource?n.a.createElement(ne,{key:t.id,rating:t}):n.a.createElement(ce,{key:t.id,bottle:t})}))),n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"d-flex justify-content-center mb-2"},e.resources.length>c&&n.a.createElement(H.a,{onClick:function(){l(c+5)}},"Load more ..."))))},se=function(e){var t=function(e,t){return t.added>e.added?1:-1},a=e.bottles.filter(function(e){return!e.user.hidden}).sort(t),r=e.ratings.sort(t);return n.a.createElement(G.a,{fluid:!0,className:"home"},n.a.createElement(P.a,null,n.a.createElement(Y.a,{as:M.a,className:"text-center"},n.a.createElement("h1",null,"Bottlestash"),n.a.createElement("h5",null,"Cooler than your wine cellar - wetter than Finnish summer"),n.a.createElement("h6",null,"(or something similar)"))),e.user?n.a.createElement(n.a.Fragment,null,n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv"},n.a.createElement("h2",{style:{color:"white",textShadow:"2px 2px 5px black"}},"Recently added bottles"))),n.a.createElement(le,{resources:a,resource:"bottle"}),n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv"},n.a.createElement("h2",{style:{color:"white",textShadow:"2px 2px 5px black"}},"Recently added ratings"))),n.a.createElement(le,{resources:r,resource:"rating"})):n.a.createElement(n.a.Fragment,null,n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv",style:{backgroundColor:"rgb(245, 245, 245)"}},n.a.createElement("section",null,n.a.createElement("h2",{className:"mb-3"},"Bottlestash, eh?"),n.a.createElement("h6",{className:"mb-4"},"That's right mate! Bottlestash is an app which lets you keep track of your beer cellar. Because lets face it; you like beer. So do I - it's allright!"),n.a.createElement("h6",null,"With Bottlestash you can manage your beer cellar, so you can easily track what beers you have, how many bottles and when to drink them!")))),n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv",style:{backgroundColor:"rgb(245, 245, 245)"}},n.a.createElement("h2",{className:"mb-3"},"Main features:"),n.a.createElement(Z.a,{variant:"flush"},n.a.createElement(Z.a.Item,null,n.a.createElement("h6",null,"Save bottles to your stash")),n.a.createElement(Z.a.Item,null,n.a.createElement("h6",null,"Keep track of your beers expiration and drink them before")),n.a.createElement(Z.a.Item,null,n.a.createElement("h6",null,"Rate beers you drink")),n.a.createElement(Z.a.Item,null,n.a.createElement("h6",null,"Peek other user's cellars and see what beers they have"))))),n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv",style:{backgroundColor:"rgb(245, 245, 245)"}},n.a.createElement("h6",{className:"mb-2"},"Register now - it's free!"),n.a.createElement(F.c,{to:"/register"},"To registration")))))},ue=a(143),oe=a(144),ie=function(e){return{type:"SET_FILTER",filter:e}},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FILTER":return t.filter;default:return e}},fe=Object(s.b)(function(e){return{beers:e.beers,breweries:e.breweries}})(function(e){var t=(e.beers?e.beers.map(function(e){return e.name}):[]).concat(e.breweries?e.breweries.map(function(e){return e.name}):[]);return n.a.createElement(W.a,{onSubmit:e.handleSearch,inline:!0,className:"pl-2"},n.a.createElement(W.a.Control,{list:e.id,name:"filter",type:"text",className:"p-2 m-2",placeholder:"search for bottles, beers and more ..."}),n.a.createElement(z,{suggestions:t,id:e.id}),n.a.createElement(H.a,{type:"submit"},"Search"))}),de={logoutUser:w,setFilter:ie,setNotification:q},pe=Object(s.b)(null,de)(Object(V.e)(function(e){return n.a.createElement(G.a,{fluid:!0},n.a.createElement(P.a,null,n.a.createElement(ue.a,{as:M.a,collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark"},n.a.createElement(ue.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),n.a.createElement(ue.a.Collapse,{id:"responsive-navbar-nav"},n.a.createElement(oe.a,{className:"mr-auto"},n.a.createElement(oe.a.Link,{href:"#",as:"span"},n.a.createElement(F.c,{to:"/"},"Home")),!e.user&&n.a.createElement(n.a.Fragment,null,n.a.createElement(oe.a.Link,{href:"#",as:"span"},n.a.createElement(F.c,{to:"/login"},"Login")),n.a.createElement(oe.a.Link,{href:"#",as:"span"},n.a.createElement(F.c,{to:"/register"},"Create account"))),e.user&&n.a.createElement(n.a.Fragment,null,n.a.createElement(oe.a.Link,{href:"#",as:"span"},n.a.createElement(F.c,{to:"/users/".concat(e.user.id,"/stash")},"Manage stash")),n.a.createElement(oe.a.Link,{href:"#",as:"span"},n.a.createElement(F.c,{to:"/rate"},"Rate beer")),n.a.createElement(oe.a.Link,{href:"#"},n.a.createElement(oe.a.Item,{onClick:function(){try{e.logoutUser(),e.setNotification("Logout was successfull"),e.history.push("/")}catch(t){e.setNotification("Logout failed!","error")}}},"Logout")))),e.user&&n.a.createElement(n.a.Fragment,null,!e.user.picture&&n.a.createElement(oe.a.Link,{href:"#",as:"span"},n.a.createElement(F.c,{to:"/profile"},"Profile")),e.user.picture&&n.a.createElement(F.c,{to:"/profile"},n.a.createElement($.a.Img,{src:"/api/pictures/".concat(e.user.picture),href:"/profile",style:{width:"50px",height:"50px",borderRadius:"50%"},alt:"Profile"})),n.a.createElement(fe,{handleSearch:function(t){t.preventDefault(),e.setFilter(t.target.filter.value),t.target.filter.value="",e.history.push("/search")},id:"search"}))))))})),Ee={registerUser:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.create(e);case 2:r=t.sent,a({type:"REGISTER_USER",newUser:r});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},setNotification:q},be=Object(s.b)(null,Ee)(Object(V.e)(function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),c=a[0],l=a[1],s=h("text",5,20,!0),u=Object(m.a)(s,2),f=u[0],d=u[1],p=h("password",5,20,!0),E=Object(m.a)(p,2),b=E[0],v=E[1],g=h("text",1,20,!0),w=Object(m.a)(g,2),y=w[0],x=w[1],O=h("text",1,50,!0),N=Object(m.a)(O,2),k=N[0],j=N[1],T=h("text",1,50,!1),B=Object(m.a)(T,2),S=B[0],R=B[1],A=h("text",1,50,!1),I=Object(m.a)(A,2),L=I[0],C=I[1],U=Object(r.useState)(!1),D=Object(m.a)(U,2),_=D[0],F=D[1],V=function(){var t=Object(i.a)(o.a.mark(function t(a){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),a.target.checkValidity()){t.next=4;break}return l(!0),t.abrupt("return");case 4:return t.prev=4,t.next=7,e.registerUser({username:f.value,password:b.value,name:y.value,email:k.value,city:S.value,country:L.value,hidden:_});case 7:e.setNotification("Registration was succesfull"),e.history.push("/login"),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),e.setNotification("Registration failed","error");case 14:case"end":return t.stop()}},t,null,[[4,11]])}));return function(e){return t.apply(this,arguments)}}();return n.a.createElement(G.a,{fluid:!0},n.a.createElement(P.a,null,n.a.createElement(Y.a,{as:M.a,className:"text-center"},n.a.createElement("h2",null,"Register to Bottlestash"))),n.a.createElement(P.a,{className:"mb-3"},n.a.createElement(M.a,{className:"formstyle"},n.a.createElement(W.a,{noValidate:!0,validated:c,onSubmit:V,id:"registerForm"},n.a.createElement(K,{name:"Username",state:f,placeholder:"username (not showing others)",errors:d}),n.a.createElement(K,{name:"Password",state:b,placeholder:"password",errors:v}),n.a.createElement(K,{name:"Name",state:y,placeholder:"name (to show other users)",errors:x}),n.a.createElement(K,{name:"Email",state:k,placeholder:"email",errors:j}),n.a.createElement(W.a.Row,null,n.a.createElement(M.a,{style:{maxWidth:"50%"},className:"p-2"},n.a.createElement(K,{name:"City",state:S,placeholder:"(optional)",errors:R})),n.a.createElement(M.a,{style:{maxWidth:"50%"},className:"p-2"},n.a.createElement(K,{name:"Country",state:L,placeholder:"(optional)",errors:C}))),n.a.createElement(W.a.Group,null,n.a.createElement(W.a.Check,{type:"checkbox",onChange:function(e){var t=e.target;return F(t.checked)},label:"I want my stash to be private"})),n.a.createElement(H.a,{variant:"success",type:"submit",block:!0},"Register")))))})),he=a(83),ve=a(142),ge={removeBottle:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.remove(e);case 2:a({type:"REMOVE_BOTTLE",id:e});case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},updateBottle:function(e,t){return function(){var a=Object(i.a)(o.a.mark(function a(r){var n;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,D.update(e,t);case 2:n=a.sent,r({type:"UPDATE_BOTTLE",updatedBottle:n});case 4:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},updateUserToState:N,setNotification:q},we=Object(s.b)(null,ge)(function(e){if(!e.bottle)return null;var t=e.bottle,a=function(){var a=Object(i.a)(o.a.mark(function a(r){var n;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,n=Object(he.a)({},t,{beer:t.beer.id,count:t.count-1}),!(t.count<2)){a.next=8;break}return a.next=5,e.removeBottle(t.id);case 5:e.setNotification("This was your last bottle of ".concat(t.beer.name)),a.next=11;break;case 8:return a.next=10,e.updateBottle(t.id,n);case 10:e.setNotification("You drinked one bottle of ".concat(t.beer.brewery.name," ").concat(t.beer.name));case 11:e.updateUserToState(e.user.username),r&&e.toggleVisibility(),a.next=18;break;case 15:a.prev=15,a.t0=a.catch(0),e.setNotification("Bottle update failed!","error");case 18:case"end":return a.stop()}},a,null,[[0,15]])}));return function(e){return a.apply(this,arguments)}}();return n.a.createElement(ve.a,{className:"text-center",centered:!0,show:e.visible,onHide:e.toggleVisibility},n.a.createElement(ve.a.Header,{closeButton:!0},n.a.createElement(ve.a.Title,null,t.beer.name)),n.a.createElement(ve.a.Body,null,n.a.createElement("p",null,"Alcohol: ",t.beer.abv," %"),n.a.createElement("p",null,"Brewery: ",t.beer.brewery.name),n.a.createElement("p",null,"Price: ",t.price?t.price:"-"," \u20ac"),n.a.createElement("p",null,"Volume: ",t.volume," litres"),n.a.createElement("p",null,"Bottled: ",t.bottled?re()(t.bottled).format("DD.MM.YYYY"):"-"),n.a.createElement("p",null,"Expires: ",t.expiration?re()(t.expiration).format("DD.MM.YYYY"):"-"),n.a.createElement("p",null,"Beers age: ",t.bottled?re()(new Date).diff(re()(t.bottled),"months"):"-"," months"),n.a.createElement("p",null,"Bottles: ",t.count)),e.user.username===e.userToView.username&&n.a.createElement(ve.a.Footer,null,n.a.createElement(F.c,{className:"btn",onClick:function(){return a(!1)},to:{pathname:"/rate",state:{bottle:t}}},"Drink and rate"),n.a.createElement(H.a,{onClick:function(){return a(!0)},variant:"light"},"Just drink")))}),ye=function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),c=a[0],l=a[1],s=Object(r.useState)(null),u=Object(m.a)(s,2),o=u[0],i=u[1];if(!e.stash)return null;return n.a.createElement(M.a,{className:"maindiv"},n.a.createElement(ee.a,{hover:!0,responsive:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,"Count"),n.a.createElement("th",null,"Brewery"),n.a.createElement("th",null,"Beer"),n.a.createElement("th",null,"Expiration"))),n.a.createElement("tbody",null,e.stash.map(function(e){return n.a.createElement("tr",{key:e.id,onClick:function(){return function(e){i(e),l(!0)}(e)}},n.a.createElement("td",null,e.count),n.a.createElement("td",null,e.beer.brewery.name),n.a.createElement("td",null,e.beer.name," ",e.beer.abv," %"),n.a.createElement("td",{style:{color:re()(e.expiration).isBefore(new Date)?"red":"black"}},e.expiration?re()(e.expiration).fromNow():"-"))}))),n.a.createElement(we,{user:e.user,userToView:e.userToView,bottle:o,visible:c,toggleVisibility:function(){l(!c)}}))},xe=function(e){var t=e.stash,a=t.reduce(function(e,t){return e+t.count},0),r=t.reduce(function(e,t){return e+t.price},0),c=t.reduce(function(e,t){return e+t.volume},0);return n.a.createElement(M.a,{className:"maindiv"},n.a.createElement($.a,null,n.a.createElement($.a.Header,null,n.a.createElement($.a.Title,null,"Details of your stash")),n.a.createElement(Z.a,{variant:"flush"},n.a.createElement(Z.a.Item,null,a," bottles in your stash"),n.a.createElement(Z.a.Item,null,t.length," different beers"),n.a.createElement(Z.a.Item,null,"Your stash costs ",r.toFixed(2)," \u20ac"),n.a.createElement(Z.a.Item,null,"Your stash has ",c.toFixed(2)," litres of beer"))))},Oe=function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),c=a[0],l=a[1];return e.userToView?n.a.createElement(G.a,{fluid:!0},n.a.createElement(P.a,null,n.a.createElement(Y.a,{as:M.a,className:"text-center"},n.a.createElement("h2",null,e.userToView.name," 's Stash"))),e.userToView.username===e.user.username&&e.userToView.hidden&&n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv"},n.a.createElement("p",null,"Your stash is hidden and won't show to other users. If you wan't to make it visible to other users, please update visibility settings in your profile"))),e.userToView.username!==e.user.username&&e.userToView.hidden&&n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv"},n.a.createElement("p",null,"This stash is private and cannot be peeked - sorry!"))),e.userToView.username===e.user.username&&n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"d-flex justify-content-center mb-4"},n.a.createElement(oe.a,null,n.a.createElement(oe.a.Link,{onClick:function(){return l(!c)},className:"p-2"},c?"Back to stash":"Stash details"),n.a.createElement(oe.a.Link,{as:"span",className:"p-2"},n.a.createElement(F.c,{to:"/bottles"},"Add new bottle"))))),(e.userToView.username===e.user.username||!e.userToView.hidden)&&n.a.createElement(P.a,{className:"mb-3"},c?n.a.createElement(xe,{stash:e.userToView.stash}):n.a.createElement(ye,{stash:e.userToView.stash,user:e.user,userToView:e.userToView}))):null},Ne=function(e){return n.a.createElement(Y.a,{className:"mt-5",style:{backgroundColor:"whitesmoke",color:"black"}},n.a.createElement(P.a,null,n.a.createElement(M.a,null,n.a.createElement(oe.a,{className:"justify-content-center"},n.a.createElement(oe.a.Link,{as:"span"},n.a.createElement(F.c,{to:"/"},"Home")),n.a.createElement(oe.a.Link,{as:"span"},n.a.createElement(F.c,{to:"/about"},"About")),n.a.createElement(oe.a.Link,{href:"https://github.com/MiguelSombrero/bottlestash-app-backend"},"Github")))),n.a.createElement(P.a,{className:"mt-4"},n.a.createElement(M.a,{className:"text-center"},n.a.createElement("p",null,"\xa9 Miika Somero 2019"))))},ke=b("/api/pictures"),je=function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(r=new FormData).append("picture",e),t.next=4,ke.createImage(r);case 4:return n=t.sent,t.abrupt("return",n);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},Te=function(e){return n.a.createElement(W.a.Group,{className:"custom-file mb-2"},n.a.createElement(W.a.Label,{className:"custom-file-label"},"Click to add picture"),n.a.createElement(W.a.Control,{name:"picture",className:"custom-file-input",type:"file",accept:"image/*",onChange:function(t){var a=t.target;return e.setPicture(a.files[0])}}),e.picture&&n.a.createElement($.a,{className:"mt-2",onClick:function(){return e.setPicture(null)}},n.a.createElement($.a.Img,{src:URL.createObjectURL(e.picture),alt:"",className:"img-thumbnail"})))},Be={addBeer:I,addBrewery:B,addBottle:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.create(e);case 2:r=t.sent,a({type:"ADD_BOTTLE",newBottle:r});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},addPicture:je,getOneBeer:A,getOneBrewery:T,updateUserToState:N,setNotification:q},Se=Object(s.b)(null,Be)(Object(V.e)(function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),c=a[0],l=a[1],s=Object(r.useState)(!1),u=Object(m.a)(s,2),f=u[0],d=u[1],p=Object(r.useState)(null),E=Object(m.a)(p,2),b=E[0],g=E[1],w=h("text",1,50,!0),y=Object(m.a)(w,2),x=y[0],O=y[1],N=h("text",1,50,!0),k=Object(m.a)(N,2),j=k[0],T=k[1],B=v("number",0,100,.1,!0),S=Object(m.a)(B,2),R=S[0],A=S[1],I=v("number",0,1e3,.01),L=Object(m.a)(I,2),C=L[0],U=L[1],D=v("number",0,50,1,!0),_=Object(m.a)(D,2),F=_[0],V=_[1],q=v("number",0,10,.001),J=Object(m.a)(q,2),z=J[0],Q=J[1],X=v("date","1990-01-01","2050-01-01",1),Z=Object(m.a)(X,2),$=Z[0],ee=Z[1],te=v("date","1990-01-01","2050-01-01",1),ae=Object(m.a)(te,2),re=ae[0],ne=ae[1],ce=function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n,c,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),a.target.checkValidity()){t.next=4;break}return l(!0),t.abrupt("return");case 4:return d(!0),t.prev=5,t.next=8,e.getOneBrewery(x.value);case 8:if(r=t.sent){t.next=13;break}return t.next=12,e.addBrewery({name:x.value});case 12:r=t.sent;case 13:return t.next=15,e.getOneBeer(r.id,j.value,R.value);case 15:if(n=t.sent){t.next=20;break}return t.next=19,e.addBeer({breweryId:r.id,name:j.value,abv:R.value});case 19:n=t.sent;case 20:if(!b){t.next=26;break}return t.next=23,e.addPicture(b);case 23:t.t0=t.sent,t.next=27;break;case 26:t.t0=null;case 27:return c=t.t0,t.next=30,e.addBottle({price:C.value,count:F.value,volume:z.value,bottled:$.value,expiration:re.value,beerId:n.id,pictureId:c?c.id:null});case 30:return t.next=32,e.updateUserToState(e.user.username);case 32:s=t.sent,d(!1),e.setNotification("Added bottle succesfully"),e.history.push("/users/".concat(s.id,"/stash")),t.next=41;break;case 38:t.prev=38,t.t1=t.catch(5),e.setNotification("Adding bottle failed!","error");case 41:case"end":return t.stop()}},t,null,[[5,38]])}));return function(e){return t.apply(this,arguments)}}();return n.a.createElement(G.a,{fluid:!0},n.a.createElement(P.a,null,n.a.createElement(Y.a,{as:M.a,className:"text-center"},n.a.createElement("h2",null,"Add new bottle to your stash"))),n.a.createElement(P.a,{className:"mb-3"},n.a.createElement(M.a,{className:"formstyle"},n.a.createElement(W.a,{noValidate:!0,validated:c,onSubmit:ce,id:"addBottleForm"},n.a.createElement(K,{name:"Brewery",suggestions:e.breweries?e.breweries.map(function(e){return e.name}):null,state:x,placeholder:"brewery name",errors:O}),n.a.createElement(K,{name:"Name",suggestions:e.beers?e.beers.filter(function(e){return e.brewery.name===x.value}).map(function(e){return e.name}):null,state:j,placeholder:"beers name",errors:T}),n.a.createElement(K,{name:"Abv",suggestions:e.beers?e.beers.filter(function(e){return e.brewery.name===x.value&&e.name===j.value}).map(function(e){return e.abv}):null,state:R,placeholder:"alcohol by volume",errors:A}),n.a.createElement(K,{name:"Count",state:F,placeholder:"number of bottles",errors:V}),n.a.createElement(K,{name:"Volume",state:z,placeholder:"volume of one bottle in litres",errors:Q}),n.a.createElement(K,{name:"Price",state:C,placeholder:"price of one bottle in euros",errors:U}),n.a.createElement(W.a.Row,null,n.a.createElement(M.a,{style:{maxWidth:"50%"},className:"p-2"},n.a.createElement(K,{name:"Bottled",state:$,errors:ee})),n.a.createElement(M.a,{style:{maxWidth:"50%"},className:"p-2"},n.a.createElement(K,{name:"Expiration",state:re,errors:ne}))),n.a.createElement(Te,{picture:b,setPicture:g}),n.a.createElement(H.a,{variant:"success",type:"submit",block:!0,disabled:f}," ",f?"Loading ...":"Add beer")))))})),Re=a(140),Ae=Object(s.b)(function(e){return{notification:e.notification}})(function(e){return e.notification?n.a.createElement(P.a,{className:"alert"},n.a.createElement(Re.a,{as:M.a,className:"text-center col-12",variant:"success"===e.notification.type?"success":"danger"},n.a.createElement("h6",null,e.notification.message))):null}),Ie={addBeer:I,getOneBeer:A,addBrewery:B,getOneBrewery:T,addRating:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C.create(e);case 2:r=t.sent,a({type:"ADD_RATING",rating:r});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},addPicture:je,setNotification:q},Le=Object(s.b)(function(e){return{beers:e.beers,breweries:e.breweries}},Ie)(Object(V.e)(function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),c=a[0],l=a[1],s=Object(r.useState)(!1),u=Object(m.a)(s,2),f=u[0],d=u[1],p=Object(r.useState)(null),E=Object(m.a)(p,2),b=E[0],g=E[1],w=h("text",1,50,!0),y=Object(m.a)(w,3),x=y[0],O=y[1],N=y[2],k=h("text",1,50,!0),j=Object(m.a)(k,3),T=j[0],B=j[1],S=j[2],R=h("text",0,1e3,!1),A=Object(m.a)(R,2),I=A[0],L=A[1],C=v("number",0,100,.1,!0),U=Object(m.a)(C,3),D=U[0],_=U[1],F=U[2],V=v("date","1990-01-01","2050-01-01",1,!1),q=Object(m.a)(V,3),J=q[0],z=q[1],Q=q[2],X=v("range",1,10,1,!0),Z=Object(m.a)(X,3),$=Z[0],ee=Z[2],te=v("range",1,10,1,!0),ae=Object(m.a)(te,3),ne=ae[0],ce=ae[2],le=v("range",1,5,1,!0),se=Object(m.a)(le,3),ue=se[0],oe=se[2],ie=v("range",1,5,1,!0),me=Object(m.a)(ie,3),fe=me[0],de=me[2],pe=v("range",1,20,1,!0),Ee=Object(m.a)(pe,3),be=Ee[0],he=Ee[2];Object(r.useEffect)(function(){if(e.location.state){var t=e.location.state.bottle;N(t.beer.name),S(t.beer.brewery.name),F(t.beer.abv),t.bottled&&Q(re()(t.bottled).format("YYYY-MM-DD"))}ee(5),ce(5),de(3),oe(3),he(10)},[]);var ve=function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n,c,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),a.target.checkValidity()){t.next=4;break}return l(!0),t.abrupt("return");case 4:if(d(!0),t.prev=5,r=null,e.beer){t.next=22;break}return t.next=10,e.getOneBrewery(T.value);case 10:if(n=t.sent){t.next=15;break}return t.next=14,e.addBrewery({name:T.value});case 14:n=t.sent;case 15:return t.next=17,e.getOneBeer(n.id,x.value,D.value);case 17:if(r=t.sent){t.next=22;break}return t.next=21,e.addBeer({breweryId:n.id,name:x.value,abv:D.value});case 21:r=t.sent;case 22:if(!b){t.next=28;break}return t.next=25,e.addPicture(b);case 25:t.t0=t.sent,t.next=29;break;case 28:t.t0=null;case 29:c=t.t0,s={beerId:void 0===e.beer?r.id:e.beer.id,description:I.value,ageofbeer:J?re()(new Date).diff(re()(J.value),"months"):null,aroma:$.value,taste:ne.value,appearance:ue.value,mouthfeel:fe.value,overall:be.value,pictureId:c?c.id:null},e.addRating(s),d(!1),e.setNotification("New rating added!"),e.history.push("/"),t.next=40;break;case 37:t.prev=37,t.t1=t.catch(5),e.setNotification("Adding a new rating failed!","error");case 40:case"end":return t.stop()}},t,null,[[5,37]])}));return function(e){return t.apply(this,arguments)}}();return n.a.createElement(G.a,{fluid:!0},n.a.createElement(P.a,null,n.a.createElement(Y.a,{as:M.a,className:"text-center mb-2"},n.a.createElement("h2",null,"Rate beer"))),n.a.createElement(P.a,{className:"mb-3"},n.a.createElement(M.a,{className:"formstyle"},n.a.createElement(W.a,{noValidate:!0,validated:c,onSubmit:ve,id:"rateForm"},n.a.createElement(K,{name:"Brewery",suggestions:e.breweries?e.breweries.map(function(e){return e.name}):null,state:T,placeholder:"brewery name",errors:B}),n.a.createElement(K,{name:"Beer",suggestions:e.beers?e.beers.filter(function(e){return e.brewery.name===T.value}).map(function(e){return e.name}):null,state:x,placeholder:"beers name",errors:O}),n.a.createElement(K,{name:"Abv",suggestions:e.beers?e.beers.filter(function(e){return e.brewery.name===T.value&&e.name===x.value}).map(function(e){return e.abv}):null,state:D,placeholder:"alcohol by volume",errors:_}),n.a.createElement(K,{name:"Bottled",state:J,errors:z}),n.a.createElement(W.a.Group,null,n.a.createElement(W.a.Label,null,"Aroma"),n.a.createElement(W.a.Text,null,$.value),n.a.createElement(W.a.Control,$)),n.a.createElement(W.a.Group,null,n.a.createElement(W.a.Label,null,"Taste"),n.a.createElement(W.a.Text,null,ne.value),n.a.createElement(W.a.Control,ne)),n.a.createElement(W.a.Group,null,n.a.createElement(W.a.Label,null,"Appearance"),n.a.createElement(W.a.Text,null,ue.value),n.a.createElement(W.a.Control,ue)),n.a.createElement(W.a.Group,null,n.a.createElement(W.a.Label,null,"Mouthfeel"),n.a.createElement(W.a.Text,null,fe.value),n.a.createElement(W.a.Control,fe)),n.a.createElement(W.a.Group,null,n.a.createElement(W.a.Label,null,"Overall"),n.a.createElement(W.a.Text,null,be.value),n.a.createElement(W.a.Control,be)),n.a.createElement(W.a.Group,null,n.a.createElement(W.a.Label,null,"Description"),n.a.createElement(W.a.Control,Object.assign({as:"textarea",rows:"4"},I,{placeholder:"describe your beer"})),n.a.createElement(W.a.Control.Feedback,{type:"invalid"},L)),n.a.createElement(Te,{picture:b,setPicture:g}),n.a.createElement(H.a,{type:"submit",variant:"success",block:!0,disabled:f}," ",f?"Loading ...":"Add Rating")))))})),Ce={removeUser:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.remove(e);case 2:a({type:"REMOVE_USER",id:e});case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},updateUser:function(e,t){return function(){var a=Object(i.a)(o.a.mark(function a(r){var n;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,O.update(e,t);case 2:n=a.sent,r({type:"UPDATE_USER",updatedUser:n});case 4:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},logoutUser:w,addPicture:je,setNotification:q},Ue=Object(s.b)(null,Ce)(Object(V.e)(function(e){var t=Object(r.useState)(!1),a=Object(m.a)(t,2),c=a[0],l=a[1],s=Object(r.useState)(null),u=Object(m.a)(s,2),f=u[0],d=u[1],p=h("text",1,20,!0),E=Object(m.a)(p,3),b=E[0],v=E[1],g=E[2],w=h("text",1,50,!0),y=Object(m.a)(w,3),x=y[0],O=y[1],N=y[2],k=h("text",1,50,!1),j=Object(m.a)(k,3),T=j[0],B=j[1],S=j[2],R=h("text",1,20,!1),A=Object(m.a)(R,3),I=A[0],L=A[1],C=A[2],U=Object(r.useState)(!1),D=Object(m.a)(U,2),_=D[0],V=D[1];if(Object(r.useEffect)(function(){e.user&&(g(e.user.name),N(e.user.email),S(e.user.city||""),C(e.user.country||""),V(e.user.hidden))},[e.user]),!e.user)return null;var q=function(){var t=Object(i.a)(o.a.mark(function t(a){var r,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),a.target.checkValidity()){t.next=4;break}return l(!0),t.abrupt("return");case 4:if(t.prev=4,!f){t.next=11;break}return t.next=8,e.addPicture(f);case 8:t.t0=t.sent,t.next=12;break;case 11:t.t0=null;case 12:return r=t.t0,n={name:b.value,email:x.value,city:T.value,country:I.value,pictureId:r?r.id:e.user.picture,hidden:_},t.next=16,e.updateUser(e.user.id,n);case 16:e.setNotification("Profile saved!"),t.next=22;break;case 19:t.prev=19,t.t1=t.catch(4),e.setNotification("Saving profile failed!","error");case 22:case"end":return t.stop()}},t,null,[[4,19]])}));return function(e){return t.apply(this,arguments)}}(),J=function(){var t=Object(i.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.confirm("Are you sure you want to delete your profile and all its data?")){t.next=13;break}return t.prev=1,t.next=4,e.removeUser(e.user.id);case 4:return t.next=6,e.logoutUser();case 6:e.setNotification("Your profile and data has been deleted"),e.history.push("/"),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),e.setNotification("Removing yor profile failed!","error");case 13:case"end":return t.stop()}},t,null,[[1,10]])}));return function(){return t.apply(this,arguments)}}();return n.a.createElement(G.a,{fluid:!0},n.a.createElement(P.a,null,n.a.createElement(Y.a,{as:M.a,className:"text-center mb-2"},n.a.createElement("h2",null,e.user.username," 's profile"))),n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"d-flex justify-content-center mb-4"},n.a.createElement(oe.a,null,n.a.createElement(oe.a.Link,{as:"span",className:"p-2"},n.a.createElement(F.c,{to:"/users/".concat(e.user.id,"/stash")},"Your stash")),n.a.createElement(oe.a.Link,{as:"span",className:"p-2"},n.a.createElement(F.c,{to:"/users/".concat(e.user.id,"/ratings")},"Your ratings")),n.a.createElement(oe.a.Link,{onClick:J,className:"p-2"},"Delete profile")))),n.a.createElement(P.a,{className:"mb-3"},n.a.createElement(M.a,{className:"formstyle"},n.a.createElement(W.a,{noValidate:!0,validated:c,onSubmit:q,id:"profileUpdateForm"},n.a.createElement(K,{name:"Name",state:b,errors:v}),n.a.createElement(K,{name:"Email",state:x,errors:O}),n.a.createElement(K,{name:"Name",state:b,errors:v}),n.a.createElement(W.a.Row,null,n.a.createElement(M.a,{style:{maxWidth:"50%"},className:"p-2"},n.a.createElement(K,{name:"City",state:T,errors:B})),n.a.createElement(M.a,{style:{maxWidth:"50%"},className:"p-2"},n.a.createElement(K,{name:"Country",state:I,errors:L}))),n.a.createElement(W.a.Group,null,n.a.createElement(W.a.Check,{type:"checkbox",checked:_,onChange:function(e){var t=e.target;return V(t.checked)},label:"I want my stash to be private"})),n.a.createElement(Te,{picture:f,setPicture:d}),n.a.createElement(H.a,{type:"submit",variant:"success",block:!0},"Save profile")))))})),De={setFilter:ie},_e=Object(s.b)(function(e){return{filter:e.filter,bottles:e.bottles,beers:e.beers,breweries:e.breweries}},De)(function(e){var t=function(t){return!!e.filter&&t.name.toLowerCase().includes(e.filter.toLowerCase())},a=function(t){return!!e.filter&&t.name.toLowerCase().includes(e.filter.toLowerCase())},r=e.bottles?e.bottles.filter(function(e){return!e.user.hidden}).filter(function(e){return t(e.beer)||a(e.beer.brewery)}):null,c=e.beers?e.beers.filter(t):null,l=e.breweries?e.breweries.filter(a):null;return n.a.createElement(G.a,{fluid:!0},n.a.createElement(P.a,null,n.a.createElement(Y.a,{as:M.a,className:"text-center"},n.a.createElement("h2",null,"Search from Bottlestash"))),n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv d-flex justify-content-center mb-5"},n.a.createElement(fe,{handleSearch:function(t){t.preventDefault(),e.setFilter(t.target.filter.value),t.target.filter.value=""},id:"search"}))),e.filter&&n.a.createElement(n.a.Fragment,null,r.length>0?n.a.createElement(n.a.Fragment,null,n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"text-center"},n.a.createElement("h3",null,"Bottles"),n.a.createElement("p",null,r.length," bottles for search '",e.filter,"'"))),n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv"},n.a.createElement(Z.a,{variant:"flush"},r.map(function(e){return n.a.createElement(Z.a.Item,{key:e.id},e.beer.name," ",e.beer.abv," %, ",e.beer.brewery.name," ",n.a.createElement(F.c,{to:"users/".concat(e.user.id,"/stash")},"in ",e.user.name," stash"))}))))):n.a.createElement("p",{className:"text-center"},"No bottles for search '",e.filter,"'"),c.length>0?n.a.createElement(n.a.Fragment,null,n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"text-center"},n.a.createElement("h3",null,"Beers"),n.a.createElement("p",null,c.length," beers for search '",e.filter,"'"))),n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv"},n.a.createElement(Z.a,{variant:"flush"},c.map(function(e){return n.a.createElement(Z.a.Item,{key:e.id},n.a.createElement(F.c,{to:"/beers/".concat(e.id)},e.name," ",e.abv," %"),", beer by ",e.brewery.name)}))))):n.a.createElement("p",{className:"text-center"},"No beers for search '",e.filter,"'"),l.length>0?n.a.createElement(n.a.Fragment,null,n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"text-center"},n.a.createElement("h3",null,"Breweries"),n.a.createElement("p",null,l.length," breweries for search '",e.filter,"'"))),n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv"},n.a.createElement(Z.a,{variant:"flush"},l.map(function(e){return n.a.createElement(Z.a.Item,{key:e.id},n.a.createElement(F.c,{to:"/breweries/".concat(e.id)},e.name))}))))):n.a.createElement("p",{className:"text-center"},"No breweries for search '",e.filter,"'")))}),Fe=function(e){var t=e.brewery;return t?n.a.createElement(G.a,{fluid:!0},n.a.createElement(P.a,null,n.a.createElement(Y.a,{as:M.a,className:"text-center"},n.a.createElement("h2",null,t.name))),n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"text-center"},n.a.createElement("h3",null,"Beers"))),n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv"},n.a.createElement(Z.a,{variant:"flush"},t.beers.map(function(e){return n.a.createElement(Z.a.Item,{key:e.id},n.a.createElement(F.c,{to:"/beers/".concat(e.id)},e.name," ",e.abv," %"))}))))):null},Ve=function(e){var t=e.beer,a=e.ratings;if(!t)return null;return n.a.createElement(G.a,{fluid:!0},n.a.createElement(P.a,null,n.a.createElement(Y.a,{as:M.a,className:"text-center"},n.a.createElement("h2",null,t.name," ",t.abv," %"),n.a.createElement("h5",null,t.brewery.name))),a.length>0?n.a.createElement(n.a.Fragment,null,n.a.createElement(P.a,{className:"mb-4"},n.a.createElement(M.a,{className:"text-center"},n.a.createElement("h6",null,a.length," ratings with average score ",n.a.createElement(te.a,{variant:"secondary"},(a.reduce(function(e,t){return e+function(e){return e.overall+e.aroma+e.taste+e.mouthfeel+e.appearance}(t)},0)/a.length).toFixed(1),"/50")))),n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"text-center"},n.a.createElement("h3",null,"Ratings"))),n.a.createElement(le,{resources:a,resource:"rating"})):n.a.createElement("h6",{className:"text-center"},"No ratings for this beer"))},Ge=function(){return n.a.createElement(G.a,{fluid:!0},n.a.createElement(P.a,null,n.a.createElement(Y.a,{as:M.a,className:"text-center"},n.a.createElement("h2",null,"About Bottlestash"))),n.a.createElement(P.a,null,n.a.createElement(M.a,{className:"maindiv"},n.a.createElement("p",null,"Bottlestash is my (Miika Somero) course project for University of Helsinki course ",n.a.createElement("a",{href:"https://fullstackopen.com/"},"Full Stack Open 2019"),"."),n.a.createElement("p",null,"Project is about rehearsing web development with React and Node.js. See source code and documentation from my ",n.a.createElement("a",{href:"https://github.com/MiguelSombrero/bottlestash-app-backend"},"Github")," page"))))},Pe=Object(V.e)(function(e){var t=e.children,a=e.location.pathname;return Object(r.useEffect)(function(){window.scrollTo(0,0)},[a]),t||null}),Ye=(a(131),{setUserToState:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(a){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:E(e.token),a({type:"LOGIN",user:e});case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},getAllUsers:function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.getAll();case 2:a=e.sent,t({type:"GET_USERS",users:a});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},getAllBreweries:function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getAll();case 2:a=e.sent,t({type:"GET_BREWERIES",breweries:a});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},getAllBeers:function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.getAll();case 2:a=e.sent,t({type:"GET_BEERS",beers:a});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},getAllRatings:function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.getAll();case 2:a=e.sent,t({type:"GET_RATINGS",ratings:a});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},getAllBottles:function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.getAll();case 2:a=e.sent,t({type:"GET_BOTTLES",bottles:a});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}}),Me=Object(s.b)(function(e){return{user:e.user,users:e.users,breweries:e.breweries,beers:e.beers,bottles:e.bottles,ratings:e.ratings}},Ye)(function(e){Object(r.useEffect)(function(){var t=window.localStorage.getItem("loggedBottlestashUser");t&&e.setUserToState(JSON.parse(t))},[]),Object(r.useEffect)(function(){e.getAllUsers()},[]),Object(r.useEffect)(function(){e.getAllBreweries()},[]),Object(r.useEffect)(function(){e.getAllBeers()},[]),Object(r.useEffect)(function(){e.getAllRatings()},[]),Object(r.useEffect)(function(){e.getAllBottles()},[]);var t=function(t){return e.ratings.filter(function(e){return e.beer.id===t})},a=function(){return e.user?e.users.find(function(t){return t.username===e.user.username}):null};return n.a.createElement(n.a.Fragment,null,n.a.createElement(F.a,null,n.a.createElement(Pe,null),n.a.createElement(pe,{user:a()}),n.a.createElement(Ae,null),n.a.createElement(V.a,{exact:!0,path:"/",render:function(){return n.a.createElement(se,{user:e.user,users:e.users,bottles:e.bottles,ratings:e.ratings})}}),n.a.createElement(V.a,{exact:!0,path:"/login",render:function(){return n.a.createElement(X,null)}}),n.a.createElement(V.a,{exact:!0,path:"/register",render:function(){return n.a.createElement(be,null)}}),n.a.createElement(V.a,{exact:!0,path:"/about",render:function(){return n.a.createElement(Ge,null)}}),n.a.createElement(V.a,{exact:!0,path:"/search",render:function(){return n.a.createElement(_e,null)}}),n.a.createElement(V.a,{exact:!0,path:"/breweries/:id/",render:function(t){var a,r=t.match;return n.a.createElement(Fe,{brewery:(a=r.params.id,e.breweries.find(function(e){return e.id===a}))})}}),n.a.createElement(V.a,{exact:!0,path:"/beers/:id/",render:function(a){var r,c=a.match;return n.a.createElement(Ve,{beer:(r=c.params.id,e.beers.find(function(e){return e.id===r})),ratings:t(c.params.id)})}}),e.user&&n.a.createElement(n.a.Fragment,null,n.a.createElement(V.a,{exact:!0,path:"/bottles",render:function(){return n.a.createElement(Se,{breweries:e.breweries,beers:e.beers,user:e.user})}}),n.a.createElement(V.a,{exact:!0,path:"/users/:id/ratings",render:function(t){var a,r=t.match;return n.a.createElement(le,{resources:(a=r.params.id,e.ratings.filter(function(e){return e.user.id===a})),resource:"rating"})}}),n.a.createElement(V.a,{exact:!0,path:"/rate",render:function(e){return n.a.createElement(Le,e)}}),n.a.createElement(V.a,{exact:!0,path:"/profile",render:function(){return n.a.createElement(Ue,{user:a()})}}),n.a.createElement(V.a,{exact:!0,path:"/users/:id/stash",render:function(t){var a,r=t.match;return n.a.createElement(Oe,{userToView:(a=r.params.id,e.users.find(function(e){return e.id===a})),user:e.user})}})),n.a.createElement(Ne,null)))}),We=a(37),He=a(82),qe=Object(We.c)({user:y,users:k,beers:L,breweries:S,notification:J,ratings:U,bottles:_,filter:me}),Je=Object(We.d)(qe,Object(We.a)(He.a));l.a.render(n.a.createElement(s.a,{store:Je},n.a.createElement(Me,null)),document.getElementById("root"))},84:function(e,t,a){e.exports=a(132)}},[[84,1,2]]]);
//# sourceMappingURL=main.e11c5c19.chunk.js.map